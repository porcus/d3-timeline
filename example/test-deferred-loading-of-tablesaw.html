<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Test of Dynamic and Deferred Loading of Tablesaw</title>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/tablesaw@3.0.9/dist/tablesaw.min.css" rel="stylesheet" type="text/css">
    <script>
        var deferLoadingTablesawAfterDOMContentLoaded = !true;
  
        function loadTablesawDynamically() {
          $('head').append('<script src="tablesaw-original.js">< /script>');
          setTimeout(function() { 
            afterLoadingTablesaw();
          }, 400);
        }
  
        function afterLoadingTablesaw() {
          var tableHtml = [
            '<table data-tablesaw-mode="columntoggle" data-tablesaw-sortable>',
            '<thead>',
              '<tr>',
                '<th data-tablesaw-priority="1" data-tablesaw-sortable-col>Header 1</th>',
                '<th data-tablesaw-sortable-col data-tablesaw-sortable-numeric>Header 2</th>',
                '<th>Header 3</th>',
                '<th data-tablesaw-priority="6">Header 4</th>',
              '</tr>',
            '</thead>',
            '<tbody>',
              '<tr>',
                '<td>Body Row 1</td>',
                '<td>1</td>',
                '<td>foo</td>',
                '<td>bar</td>',
              '</tr>',
              '<tr>',
                '<td>Body Row 2</td>',
                '<td>2</td>',
                '<td>foo</td>',
                '<td>bar</td>',
              '</tr>',
              '<tr>',
                '<td>Body Row 3</td>',
                '<td>3</td>',
                '<td>foo</td>',
                '<td>bar</td>',
              '</tr>',
            '</tbody>',
            '</table>'].join('');
  
          $('#table-placeholder').html(tableHtml);
          Tablesaw.init();
          //alert( "tablesaw initialized: " + tablesawIsInitialized() );
        }

        function tablesawIsInitialized() {
          return !!$('.tablesaw-columntoggle').length;
        }
  
        if (deferLoadingTablesawAfterDOMContentLoaded)
        {
          setTimeout(function() { 
            loadTablesawDynamically();
          }, 500);
        }
        else
        {
          loadTablesawDynamically();
        }
  
      </script>   
  </head>
  <body>
    <div id="table-placeholder"></div>
  </body>
</html>