{"version":3,"sources":["tablesaw.js"],"names":["factory","define","amd","module","exports","win","window","doc","document","shoestring","prim","sec","pType","ret","sel","Shoestring","call","ready","constructor","indexOf","dfrag","createElement","innerHTML","children","each","removeChild","find","querySelectorAll","Object","prototype","toString","NodeList","Array","length","selector","merge","reverse","fn","extend","first","second","i","hasOwnProperty","len","j","callback","collection","val","il","inArray","needle","haystack","isin","readyQueue","push","runReady","shift","attachEvent","readyState","addEventListener","is","self","parents","check","_checkElements","parent","e","needles","data","name","value","undefined","shoestringData","removeData","$","addClass","className","classes","replace","split","match","RegExp","add","append","fragment","nodeType","jl","appendChild","cloneNode","appendTo","attr","nameStr","setAttribute","getAttribute","before","parentNode","insertBefore","childs","closest","element","$self","parentElement","cssExceptions","convertPropertyName","str","character","toUpperCase","_getStyle","property","getComputedStyle","getPropertyValue","vendorPrefixes","convert","k","_setStyle","convertedProperty","style","css","key","eq","index","filter","wsel","context","createDocumentFragment","finds","concat","get","elements","set","html","h","l","outerHTML","pile","_getIndex","test","result","item","documentElement","childNodes","last","next","found","not","prepend","insertEl","firstChild","prev","prevAll","$previous","removeAttr","removeAttribute","removeClass","cname","newClassName","regex","remove","replaceWith","clone","replaceChild","nextSibling","siblings","sibs","el","getText","elem","node","textContent","nodeValue","text","tagName","optionSet","option","options","values","newIndex","selected","selectedIndex","_dimension","offsetName","letter","width","wrapInner","inH","initEventCache","evt","events","loop","addToEventCache","eventInfo","obj","isCustomEvent","callfunc","originalCallback","namespace","customEventLoop","bind","evts","encasedCallback","triggeredElement","_namespace","returnTrue","isDefaultPrevented","originalPreventDefault","preventDefault","preventDefaultConstructor","returnValue","target","srcElement","stopPropagation","cancelBubble","apply","_args","domEventCallback","customEventCallback","oEl","originalEvent","ssEventTrigger","on","unbind","event","unbindAll","bound","matched","removeEventListener","splice","evtKey","off","one","thisevt","cbs","$t","triggerHandler","args","createEvent","bindings","initEvent","unshift","trigger","type","click","dispatchEvent","root","Tablesaw","domContentLoadedTriggered","i18n","modeStack","modeSwipe","modeToggle","modeSwitchColumnsAbbreviated","modeSwitchColumns","columnToggleButton","columnToggleError","sort","swipePreviousColumn","swipeNextColumn","mustard","blackberry","WebKitPoint","operamini","_init","init","TablesawConfig","modes","pluginName","toolbar","create","destroy","refresh","resize","defaultMode","initSelector","initFilterSelector","defaultConfig","Table","Error","table","$table","$thead","$tbody","mode","$toolbar","attributes","subrow","ignorerow","Math","round","random","createToolbar","_initCells","getConfig","pluginSpecificConfig","configs","_getPrimaryHeaderRow","_getHeaderRows","_getRowIndex","$row","_getHeaderRowIndeces","indeces","_getPrimaryHeaderCells","_$getCells","th","cells","hasColspan","_getVisibleColspan","colspan","parseInt","getColspanForCell","$cell","visibleColspan","visibleSiblingColumns","colColspan","isCellInColumn","header","cell","updateColspanCells","cls","userAction","primaryHeaderRow","rowspan","maxColspan","_findPrimaryHeadersForCell","$headerRow","$headers","headerRowIndex","results","rowNumber","headerMapping","colNumber","getRows","getBodyRows","tbody","getHeaderCellIndex","lookup","colIndex","$rows","columnLookup","coltally","headerRowIndeces","headerIndex","headerCol","rowCell","_getToolbarAnchor","$parent","_getToolbar","$anchor","tableId","$doc","isScrolling","scrollTimeout","clearTimeout","setTimeout","resizeTimeout","stackTable","cellLabels","cellContentLabels","attrs","labelless","hideempty","Stack","tablesaw","$newHeader","$header","$sortableButton","$checkall","createTextNode","$label","methods","_create","getElementsByTagName","_select","update","opts","label","opt","nodeName","arrg","a","b","c","ColumnToggle","btnTarget","columnToggleTable","columnBtnContain","columnBtn","popup","priorityPrefix","initSet","id","$menuButton","$popup","$menu","$btnContain","cfg","getColumnToggleLabelTemplate","hasNonPersistentHeaders","$this","priority","$cells","onToggleCheckboxChange","checkbox","checked","getHeaderFromCheckbox","$btnTarget","closePopup","closeTimeout","openPopup","$overflow","timeout","$div","refreshToggle","invisibleColumns","refreshPriority","getSortValue","$el","join","sortableSwitchSelector","sortCol","defaultCol","numericCol","subRow","ignoreRow","head","ascend","descend","switcher","tableToolbar","sortButton","o","tblsaw","heads","$switcher","addClassToHeads","v","makeHeadsActionable","col","clearOthers","headcells","headsOnAction","headCell","newSortValue","handleDefault","idx","addSwitcher","isDefaultCol","isDescending","hasNumericAttribute","numericCount","numericCountMax","slice","isNaN","isNumeric","$firstChild","tablesawbtn","sortRows","rows","colNum","ascending","convertCells","cellArr","belongingToTbody","row","subrows","$next","ignored","getSortFxn","forceNumeric","parseFloat","toLowerCase","convertToRows","sorted","newRows","customFn","makeColDefault","sortBy","tbl","sortedRows","map","arguments","returnVal","hideBtn","persistWidths","hiddenCol","persistCol","allColumnsVisible","disableTouchEvents","createSwipeTable","$btns","$prevBtn","$nextBtn","$headerCells","$headerCellsNoPersist","headerWidths","$head","initMinHeaderWidths","offsetWidth","showColumn","headerCell","hideColumn","persistColumn","isPersistent","unmaintainWidths","maintainWidths","prefix","styles","tableWidth","hash","newHash","$style","getNext","checkFound","isHidden","getPrev","nextpair","fwd","canAdvance","pair","matchesMedia","matchMedia","matches","fakeBreakpoints","containerWidth","persist","sum","sums","visibleNonPersistantCount","isPersist","needsNonPersistentColumn","advance","getCoord","touches","originX","originY","x","y","scrollTop","pageYOffset","swipeHorizontalThreshold","swipeVerticalThreshold","verticalThreshold","swipe","horizontalThreshold","isPageScrolled","abs","isVerticalSwipe","canGoPrev","canGoNext","MiniMap","show","mq","createMiniMap","$dotNav","hideDot","showHideNav","dots","S","selectors","excludeMode","main","ignoreMode","dataMode","isSelected","$otherToolbarItems","onModeChange","CheckAll","checkAllSelector","forceCheckedSelector","forceUncheckedSelector","checkboxSelector","$triggers","$checkboxes","_filterCells","getCheckboxesForButton","button","getCheckboxesForCheckbox","$trigger","addCheckboxEvents","addButtonEvents","allChecked","setChecked","checkedCount","allSelected","indeterminate"],"mappings":"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","file":"tablesaw.js","sourcesContent":["/*! Tablesaw - v3.0.9 - 2018-02-14\n* https://github.com/filamentgroup/tablesaw\n* Copyright (c) 2018 Filament Group; Licensed MIT */\n/*! Shoestring - v2.0.0 - 2017-02-14\n* http://github.com/filamentgroup/shoestring/\n* Copyright (c) 2017 Scott Jehl, Filament Group, Inc; Licensed MIT & GPLv2 */ \n(function( factory ) {\n\tif( typeof define === 'function' && define.amd ) {\n\t\t\t// AMD. Register as an anonymous module.\n\t\t\tdefine( [ 'shoestring' ], factory );\n\t} else if (typeof module === 'object' && module.exports) {\n\t\t// Node/CommonJS\n\t\tmodule.exports = factory();\n\t} else {\n\t\t// Browser globals\n\t\tfactory();\n\t}\n}(function () {\n\tvar win = typeof window !== \"undefined\" ? window : this;\n\tvar doc = win.document;\n\n\n\t/**\n\t * The shoestring object constructor.\n\t *\n\t * @param {string,object} prim The selector to find or element to wrap.\n\t * @param {object} sec The context in which to match the `prim` selector.\n\t * @returns shoestring\n\t * @this window\n\t */\n\tfunction shoestring( prim, sec ){\n\t\tvar pType = typeof( prim ),\n\t\t\t\tret = [],\n\t\t\t\tsel;\n\n\t\t// return an empty shoestring object\n\t\tif( !prim ){\n\t\t\treturn new Shoestring( ret );\n\t\t}\n\n\t\t// ready calls\n\t\tif( prim.call ){\n\t\t\treturn shoestring.ready( prim );\n\t\t}\n\n\t\t// handle re-wrapping shoestring objects\n\t\tif( prim.constructor === Shoestring && !sec ){\n\t\t\treturn prim;\n\t\t}\n\n\t\t// if string starting with <, make html\n\t\tif( pType === \"string\" && prim.indexOf( \"<\" ) === 0 ){\n\t\t\tvar dfrag = doc.createElement( \"div\" );\n\n\t\t\tdfrag.innerHTML = prim;\n\n\t\t\t// TODO depends on children (circular)\n\t\t\treturn shoestring( dfrag ).children().each(function(){\n\t\t\t\tdfrag.removeChild( this );\n\t\t\t});\n\t\t}\n\n\t\t// if string, it's a selector, use qsa\n\t\tif( pType === \"string\" ){\n\t\t\tif( sec ){\n\t\t\t\treturn shoestring( sec ).find( prim );\n\t\t\t}\n\n\t\t\t\tsel = doc.querySelectorAll( prim );\n\n\t\t\treturn new Shoestring( sel, prim );\n\t\t}\n\n\t\t// array like objects or node lists\n\t\tif( Object.prototype.toString.call( pType ) === '[object Array]' ||\n\t\t\t\t(win.NodeList && prim instanceof win.NodeList) ){\n\n\t\t\treturn new Shoestring( prim, prim );\n\t\t}\n\n\t\t// if it's an array, use all the elements\n\t\tif( prim.constructor === Array ){\n\t\t\treturn new Shoestring( prim, prim );\n\t\t}\n\n\t\t// otherwise assume it's an object the we want at an index\n\t\treturn new Shoestring( [prim], prim );\n\t}\n\n\tvar Shoestring = function( ret, prim ) {\n\t\tthis.length = 0;\n\t\tthis.selector = prim;\n\t\tshoestring.merge(this, ret);\n\t};\n\n\t// TODO only required for tests\n\tShoestring.prototype.reverse = [].reverse;\n\n\t// For adding element set methods\n\tshoestring.fn = Shoestring.prototype;\n\n\tshoestring.Shoestring = Shoestring;\n\n\t// For extending objects\n\t// TODO move to separate module when we use prototypes\n\tshoestring.extend = function( first, second ){\n\t\tfor( var i in second ){\n\t\t\tif( second.hasOwnProperty( i ) ){\n\t\t\t\tfirst[ i ] = second[ i ];\n\t\t\t}\n\t\t}\n\n\t\treturn first;\n\t};\n\n\t// taken directly from jQuery\n\tshoestring.merge = function( first, second ) {\n\t\tvar len, j, i;\n\n\t\tlen = +second.length,\n\t\tj = 0,\n\t\ti = first.length;\n\n\t\tfor ( ; j < len; j++ ) {\n\t\t\tfirst[ i++ ] = second[ j ];\n\t\t}\n\n\t\tfirst.length = i;\n\n\t\treturn first;\n\t};\n\n\t// expose\n\twin.shoestring = shoestring;\n\n\n\n\t/**\n\t * Iterates over `shoestring` collections.\n\t *\n\t * @param {function} callback The callback to be invoked on each element and index\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.each = function( callback ){\n\t\treturn shoestring.each( this, callback );\n\t};\n\n\tshoestring.each = function( collection, callback ) {\n\t\tvar val;\n\t\tfor( var i = 0, il = collection.length; i < il; i++ ){\n\t\t\tval = callback.call( collection[i], i, collection[i] );\n\t\t\tif( val === false ){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn collection;\n\t};\n\n\n\n  /**\n\t * Check for array membership.\n\t *\n\t * @param {object} needle The thing to find.\n\t * @param {object} haystack The thing to find the needle in.\n\t * @return {boolean}\n\t * @this window\n\t */\n\tshoestring.inArray = function( needle, haystack ){\n\t\tvar isin = -1;\n\t\tfor( var i = 0, il = haystack.length; i < il; i++ ){\n\t\t\tif( haystack.hasOwnProperty( i ) && haystack[ i ] === needle ){\n\t\t\t\tisin = i;\n\t\t\t}\n\t\t}\n\t\treturn isin;\n\t};\n\n\n\n  /**\n\t * Bind callbacks to be run when the DOM is \"ready\".\n\t *\n\t * @param {function} fn The callback to be run\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.ready = function( fn ){\n\t\tif( ready && fn ){\n\t\t\tfn.call( doc );\n\t\t}\n\t\telse if( fn ){\n\t\t\treadyQueue.push( fn );\n\t\t}\n\t\telse {\n\t\t\trunReady();\n\t\t}\n\n\t\treturn [doc];\n\t};\n\n\t// TODO necessary?\n\tshoestring.fn.ready = function( fn ){\n\t\tshoestring.ready( fn );\n\t\treturn this;\n\t};\n\n\t// Empty and exec the ready queue\n\tvar ready = false,\n\t\treadyQueue = [],\n\t\trunReady = function(){\n\t\t\tif( !ready ){\n\t\t\t\twhile( readyQueue.length ){\n\t\t\t\t\treadyQueue.shift().call( doc );\n\t\t\t\t}\n\t\t\t\tready = true;\n\t\t\t}\n\t\t};\n\n\t// If DOM is already ready at exec time, depends on the browser.\n\t// From: https://github.com/mobify/mobifyjs/blob/526841be5509e28fc949038021799e4223479f8d/src/capture.js#L128\n\tif (doc.attachEvent ? doc.readyState === \"complete\" : doc.readyState !== \"loading\") {\n\t\trunReady();\n\t} else {\n\t\tdoc.addEventListener( \"DOMContentLoaded\", runReady, false );\n\t\tdoc.addEventListener( \"readystatechange\", runReady, false );\n\t\twin.addEventListener( \"load\", runReady, false );\n\t}\n\n\n\n  /**\n\t * Checks the current set of elements against the selector, if one matches return `true`.\n\t *\n\t * @param {string} selector The selector to check.\n\t * @return {boolean}\n\t * @this {shoestring}\n\t */\n\tshoestring.fn.is = function( selector ){\n\t\tvar ret = false, self = this, parents, check;\n\n\t\t// assume a dom element\n\t\tif( typeof selector !== \"string\" ){\n\t\t\t// array-like, ie shoestring objects or element arrays\n\t\t\tif( selector.length && selector[0] ){\n\t\t\t\tcheck = selector;\n\t\t\t} else {\n\t\t\t\tcheck = [selector];\n\t\t\t}\n\n\t\t\treturn _checkElements(this, check);\n\t\t}\n\n\t\tparents = this.parent();\n\n\t\tif( !parents.length ){\n\t\t\tparents = shoestring( doc );\n\t\t}\n\n\t\tparents.each(function( i, e ) {\n\t\t\tvar children;\n\n\t\t\t\t\tchildren = e.querySelectorAll( selector );\n\n\t\t\tret = _checkElements( self, children );\n\t\t});\n\n\t\treturn ret;\n\t};\n\n\tfunction _checkElements(needles, haystack){\n\t\tvar ret = false;\n\n\t\tneedles.each(function() {\n\t\t\tvar j = 0;\n\n\t\t\twhile( j < haystack.length ){\n\t\t\t\tif( this === haystack[j] ){\n\t\t\t\t\tret = true;\n\t\t\t\t}\n\n\t\t\t\tj++;\n\t\t\t}\n\t\t});\n\n\t\treturn ret;\n\t}\n\n\n\n\t/**\n\t * Get data attached to the first element or set data values on all elements in the current set.\n\t *\n\t * @param {string} name The data attribute name.\n\t * @param {any} value The value assigned to the data attribute.\n\t * @return {any|shoestring}\n\t * @this shoestring\n\t */\n\tshoestring.fn.data = function( name, value ){\n\t\tif( name !== undefined ){\n\t\t\tif( value !== undefined ){\n\t\t\t\treturn this.each(function(){\n\t\t\t\t\tif( !this.shoestringData ){\n\t\t\t\t\t\tthis.shoestringData = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.shoestringData[ name ] = value;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif( this[ 0 ] ) {\n\t\t\t\t\tif( this[ 0 ].shoestringData ) {\n\t\t\t\t\t\treturn this[ 0 ].shoestringData[ name ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\treturn this[ 0 ] ? this[ 0 ].shoestringData || {} : undefined;\n\t\t}\n\t};\n\n\n\t/**\n\t * Remove data associated with `name` or all the data, for each element in the current set.\n\t *\n\t * @param {string} name The data attribute name.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.removeData = function( name ){\n\t\treturn this.each(function(){\n\t\t\tif( name !== undefined && this.shoestringData ){\n\t\t\t\tthis.shoestringData[ name ] = undefined;\n\t\t\t\tdelete this.shoestringData[ name ];\n\t\t\t}\telse {\n\t\t\t\tthis[ 0 ].shoestringData = {};\n\t\t\t}\n\t\t});\n\t};\n\n\n\n\t/**\n\t * An alias for the `shoestring` constructor.\n\t */\n\twin.$ = shoestring;\n\n\n\n\t/**\n\t * Add a class to each DOM element in the set of elements.\n\t *\n\t * @param {string} className The name of the class to be added.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.addClass = function( className ){\n\t\tvar classes = className.replace(/^\\s+|\\s+$/g, '').split( \" \" );\n\n\t\treturn this.each(function(){\n\t\t\tfor( var i = 0, il = classes.length; i < il; i++ ){\n\t\t\t\tif( this.className !== undefined &&\n\t\t\t\t\t\t(this.className === \"\" ||\n\t\t\t\t\t\t!this.className.match( new RegExp( \"(^|\\\\s)\" + classes[ i ] + \"($|\\\\s)\"))) ){\n\t\t\t\t\tthis.className += \" \" + classes[ i ];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\n\n  /**\n\t * Add elements matching the selector to the current set.\n\t *\n\t * @param {string} selector The selector for the elements to add from the DOM\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.add = function( selector ){\n\t\tvar ret = [];\n\t\tthis.each(function(){\n\t\t\tret.push( this );\n\t\t});\n\n\t\tshoestring( selector ).each(function(){\n\t\t\tret.push( this );\n\t\t});\n\n\t\treturn shoestring( ret );\n\t};\n\n\n\n\t/**\n\t * Insert an element or HTML string as the last child of each element in the set.\n\t *\n\t * @param {string|HTMLElement} fragment The HTML or HTMLElement to insert.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.append = function( fragment ){\n\t\tif( typeof( fragment ) === \"string\" || fragment.nodeType !== undefined ){\n\t\t\tfragment = shoestring( fragment );\n\t\t}\n\n\t\treturn this.each(function( i ){\n\t\t\tfor( var j = 0, jl = fragment.length; j < jl; j++ ){\n\t\t\t\tthis.appendChild( i > 0 ? fragment[ j ].cloneNode( true ) : fragment[ j ] );\n\t\t\t}\n\t\t});\n\t};\n\n\n\n\t/**\n\t * Insert the current set as the last child of the elements matching the selector.\n\t *\n\t * @param {string} selector The selector after which to append the current set.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.appendTo = function( selector ){\n\t\treturn this.each(function(){\n\t\t\tshoestring( selector ).append( this );\n\t\t});\n\t};\n\n\n\n  /**\n\t * Get the value of the first element of the set or set the value of all the elements in the set.\n\t *\n\t * @param {string} name The attribute name.\n\t * @param {string} value The new value for the attribute.\n\t * @return {shoestring|string|undefined}\n\t * @this {shoestring}\n\t */\n\tshoestring.fn.attr = function( name, value ){\n\t\tvar nameStr = typeof( name ) === \"string\";\n\n\t\tif( value !== undefined || !nameStr ){\n\t\t\treturn this.each(function(){\n\t\t\t\tif( nameStr ){\n\t\t\t\t\tthis.setAttribute( name, value );\n\t\t\t\t}\telse {\n\t\t\t\t\tfor( var i in name ){\n\t\t\t\t\t\tif( name.hasOwnProperty( i ) ){\n\t\t\t\t\t\t\tthis.setAttribute( i, name[ i ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\treturn this[ 0 ] ? this[ 0 ].getAttribute( name ) : undefined;\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Insert an element or HTML string before each element in the current set.\n\t *\n\t * @param {string|HTMLElement} fragment The HTML or HTMLElement to insert.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.before = function( fragment ){\n\t\tif( typeof( fragment ) === \"string\" || fragment.nodeType !== undefined ){\n\t\t\tfragment = shoestring( fragment );\n\t\t}\n\n\t\treturn this.each(function( i ){\n\t\t\tfor( var j = 0, jl = fragment.length; j < jl; j++ ){\n\t\t\t\tthis.parentNode.insertBefore( i > 0 ? fragment[ j ].cloneNode( true ) : fragment[ j ], this );\n\t\t\t}\n\t\t});\n\t};\n\n\n\n\t/**\n\t * Get the children of the current collection.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.children = function(){\n\t\t\t\tvar ret = [],\n\t\t\tchilds,\n\t\t\tj;\n\t\tthis.each(function(){\n\t\t\tchilds = this.children;\n\t\t\tj = -1;\n\n\t\t\twhile( j++ < childs.length-1 ){\n\t\t\t\tif( shoestring.inArray(  childs[ j ], ret ) === -1 ){\n\t\t\t\t\tret.push( childs[ j ] );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn shoestring(ret);\n\t};\n\n\n\n\t/**\n\t * Find an element matching the selector in the set of the current element and its parents.\n\t *\n\t * @param {string} selector The selector used to identify the target element.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.closest = function( selector ){\n\t\tvar ret = [];\n\n\t\tif( !selector ){\n\t\t\treturn shoestring( ret );\n\t\t}\n\n\t\tthis.each(function(){\n\t\t\tvar element, $self = shoestring( element = this );\n\n\t\t\tif( $self.is(selector) ){\n\t\t\t\tret.push( this );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\twhile( element.parentElement ) {\n\t\t\t\tif( shoestring(element.parentElement).is(selector) ){\n\t\t\t\t\tret.push( element.parentElement );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\telement = element.parentElement;\n\t\t\t}\n\t\t});\n\n\t\treturn shoestring( ret );\n\t};\n\n\n\n  shoestring.cssExceptions = {\n\t\t'float': [ 'cssFloat' ]\n\t};\n\n\n\n\t(function() {\n\t\tvar cssExceptions = shoestring.cssExceptions;\n\n\t\t// IE8 uses marginRight instead of margin-right\n\t\tfunction convertPropertyName( str ) {\n\t\t\treturn str.replace( /\\-([A-Za-z])/g, function ( match, character ) {\n\t\t\t\treturn character.toUpperCase();\n\t\t\t});\n\t\t}\n\n\t\tfunction _getStyle( element, property ) {\n\t\t\treturn win.getComputedStyle( element, null ).getPropertyValue( property );\n\t\t}\n\n\t\tvar vendorPrefixes = [ '', '-webkit-', '-ms-', '-moz-', '-o-', '-khtml-' ];\n\n\t\t/**\n\t\t * Private function for getting the computed style of an element.\n\t\t *\n\t\t * **NOTE** Please use the [css](../css.js.html) method instead.\n\t\t *\n\t\t * @method _getStyle\n\t\t * @param {HTMLElement} element The element we want the style property for.\n\t\t * @param {string} property The css property we want the style for.\n\t\t */\n\t\tshoestring._getStyle = function( element, property ) {\n\t\t\tvar convert, value, j, k;\n\n\t\t\tif( cssExceptions[ property ] ) {\n\t\t\t\tfor( j = 0, k = cssExceptions[ property ].length; j < k; j++ ) {\n\t\t\t\t\tvalue = _getStyle( element, cssExceptions[ property ][ j ] );\n\n\t\t\t\t\tif( value ) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( j = 0, k = vendorPrefixes.length; j < k; j++ ) {\n\t\t\t\tconvert = convertPropertyName( vendorPrefixes[ j ] + property );\n\n\t\t\t\t// VendorprefixKeyName || key-name\n\t\t\t\tvalue = _getStyle( element, convert );\n\n\t\t\t\tif( convert !== property ) {\n\t\t\t\t\tvalue = value || _getStyle( element, property );\n\t\t\t\t}\n\n\t\t\t\tif( vendorPrefixes[ j ] ) {\n\t\t\t\t\t// -vendorprefix-key-name\n\t\t\t\t\tvalue = value || _getStyle( element, vendorPrefixes[ j ] + property );\n\t\t\t\t}\n\n\t\t\t\tif( value ) {\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t};\n\t})();\n\n\n\n\t(function() {\n\t\tvar cssExceptions = shoestring.cssExceptions;\n\n\t\t// IE8 uses marginRight instead of margin-right\n\t\tfunction convertPropertyName( str ) {\n\t\t\treturn str.replace( /\\-([A-Za-z])/g, function ( match, character ) {\n\t\t\t\treturn character.toUpperCase();\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Private function for setting the style of an element.\n\t\t *\n\t\t * **NOTE** Please use the [css](../css.js.html) method instead.\n\t\t *\n\t\t * @method _setStyle\n\t\t * @param {HTMLElement} element The element we want to style.\n\t\t * @param {string} property The property being used to style the element.\n\t\t * @param {string} value The css value for the style property.\n\t\t */\n\t\tshoestring._setStyle = function( element, property, value ) {\n\t\t\tvar convertedProperty = convertPropertyName(property);\n\n\t\t\telement.style[ property ] = value;\n\n\t\t\tif( convertedProperty !== property ) {\n\t\t\t\telement.style[ convertedProperty ] = value;\n\t\t\t}\n\n\t\t\tif( cssExceptions[ property ] ) {\n\t\t\t\tfor( var j = 0, k = cssExceptions[ property ].length; j<k; j++ ) {\n\t\t\t\t\telement.style[ cssExceptions[ property ][ j ] ] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t})();\n\n\n\n\t/**\n\t * Get the compute style property of the first element or set the value of a style property\n\t * on all elements in the set.\n\t *\n\t * @method _setStyle\n\t * @param {string} property The property being used to style the element.\n\t * @param {string|undefined} value The css value for the style property.\n\t * @return {string|shoestring}\n\t * @this shoestring\n\t */\n\tshoestring.fn.css = function( property, value ){\n\t\tif( !this[0] ){\n\t\t\treturn;\n\t\t}\n\n\t\tif( typeof property === \"object\" ) {\n\t\t\treturn this.each(function() {\n\t\t\t\tfor( var key in property ) {\n\t\t\t\t\tif( property.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tshoestring._setStyle( this, key, property[key] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\telse {\n\t\t\t// assignment else retrieve first\n\t\t\tif( value !== undefined ){\n\t\t\t\treturn this.each(function(){\n\t\t\t\t\tshoestring._setStyle( this, property, value );\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn shoestring._getStyle( this[0], property );\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Returns the indexed element wrapped in a new `shoestring` object.\n\t *\n\t * @param {integer} index The index of the element to wrap and return.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.eq = function( index ){\n\t\tif( this[index] ){\n\t\t\treturn shoestring( this[index] );\n\t\t}\n\n\t\treturn shoestring([]);\n\t};\n\n\n\n\t/**\n\t * Filter out the current set if they do *not* match the passed selector or\n\t * the supplied callback returns false\n\t *\n\t * @param {string,function} selector The selector or boolean return value callback used to filter the elements.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.filter = function( selector ){\n\t\tvar ret = [];\n\n\t\tthis.each(function( index ){\n\t\t\tvar wsel;\n\n\t\t\tif( typeof selector === 'function' ) {\n\t\t\t\tif( selector.call( this, index ) !== false ) {\n\t\t\t\t\tret.push( this );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( !this.parentNode ){\n\t\t\t\t\tvar context = shoestring( doc.createDocumentFragment() );\n\n\t\t\t\t\tcontext[ 0 ].appendChild( this );\n\t\t\t\t\twsel = shoestring( selector, context );\n\t\t\t\t} else {\n\t\t\t\t\twsel = shoestring( selector, this.parentNode );\n\t\t\t\t}\n\n\t\t\t\tif( shoestring.inArray( this, wsel ) > -1 ){\n\t\t\t\t\tret.push( this );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn shoestring( ret );\n\t};\n\n\n\n\t/**\n\t * Find descendant elements of the current collection.\n\t *\n\t * @param {string} selector The selector used to find the children\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.find = function( selector ){\n\t\tvar ret = [],\n\t\t\tfinds;\n\t\tthis.each(function(){\n\t\t\t\tfinds = this.querySelectorAll( selector );\n\n\t\t\tfor( var i = 0, il = finds.length; i < il; i++ ){\n\t\t\t\tret = ret.concat( finds[i] );\n\t\t\t}\n\t\t});\n\t\treturn shoestring( ret );\n\t};\n\n\n\n\t/**\n\t * Returns the first element of the set wrapped in a new `shoestring` object.\n\t *\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.first = function(){\n\t\treturn this.eq( 0 );\n\t};\n\n\n\n\t/**\n\t * Returns the raw DOM node at the passed index.\n\t *\n\t * @param {integer} index The index of the element to wrap and return.\n\t * @return {HTMLElement|undefined|array}\n\t * @this shoestring\n\t */\n\tshoestring.fn.get = function( index ){\n\n\t\t// return an array of elements if index is undefined\n\t\tif( index === undefined ){\n\t\t\tvar elements = [];\n\n\t\t\tfor( var i = 0; i < this.length; i++ ){\n\t\t\t\telements.push( this[ i ] );\n\t\t\t}\n\n\t\t\treturn elements;\n\t\t} else {\n\t\t\treturn this[ index ];\n\t\t}\n\t};\n\n\n\n\tvar set = function( html ){\n\t\tif( typeof html === \"string\" || typeof html === \"number\" ){\n\t\t\treturn this.each(function(){\n\t\t\t\tthis.innerHTML = \"\" + html;\n\t\t\t});\n\t\t} else {\n\t\t\tvar h = \"\";\n\t\t\tif( typeof html.length !== \"undefined\" ){\n\t\t\t\tfor( var i = 0, l = html.length; i < l; i++ ){\n\t\t\t\t\th += html[i].outerHTML;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\th = html.outerHTML;\n\t\t\t}\n\t\t\treturn this.each(function(){\n\t\t\t\tthis.innerHTML = h;\n\t\t\t});\n\t\t}\n\t};\n\t/**\n\t * Gets or sets the `innerHTML` from all the elements in the set.\n\t *\n\t * @param {string|undefined} html The html to assign\n\t * @return {string|shoestring}\n\t * @this shoestring\n\t */\n\tshoestring.fn.html = function( html ){\n\t\t\t\tif( typeof html !== \"undefined\" ){\n\t\t\treturn set.call( this, html );\n\t\t} else { // get\n\t\t\tvar pile = \"\";\n\n\t\t\tthis.each(function(){\n\t\t\t\tpile += this.innerHTML;\n\t\t\t});\n\n\t\t\treturn pile;\n\t\t}\n\t};\n\n\n\n\t(function() {\n\t\tfunction _getIndex( set, test ) {\n\t\t\tvar i, result, element;\n\n\t\t\tfor( i = result = 0; i < set.length; i++ ) {\n\t\t\t\telement = set.item ? set.item(i) : set[i];\n\n\t\t\t\tif( test(element) ){\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\t// ignore text nodes, etc\n\t\t\t\t// NOTE may need to be more permissive\n\t\t\t\tif( element.nodeType === 1 ){\n\t\t\t\t\tresult++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn -1;\n\t\t}\n\n\t\t/**\n\t\t * Find the index in the current set for the passed selector.\n\t\t * Without a selector it returns the index of the first node within the array of its siblings.\n\t\t *\n\t\t * @param {string|undefined} selector The selector used to search for the index.\n\t\t * @return {integer}\n\t\t * @this {shoestring}\n\t\t */\n\t\tshoestring.fn.index = function( selector ){\n\t\t\tvar self, children;\n\n\t\t\tself = this;\n\n\t\t\t// no arg? check the children, otherwise check each element that matches\n\t\t\tif( selector === undefined ){\n\t\t\t\tchildren = ( ( this[ 0 ] && this[0].parentNode ) || doc.documentElement).childNodes;\n\n\t\t\t\t// check if the element matches the first of the set\n\t\t\t\treturn _getIndex(children, function( element ) {\n\t\t\t\t\treturn self[0] === element;\n\t\t\t\t});\n\t\t\t} else {\n\n\t\t\t\t// check if the element matches the first selected node from the parent\n\t\t\t\treturn _getIndex(self, function( element ) {\n\t\t\t\t\treturn element === (shoestring( selector, element.parentNode )[ 0 ]);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t})();\n\n\n\n\t/**\n\t * Insert the current set before the elements matching the selector.\n\t *\n\t * @param {string} selector The selector before which to insert the current set.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.insertBefore = function( selector ){\n\t\treturn this.each(function(){\n\t\t\tshoestring( selector ).before( this );\n\t\t});\n\t};\n\n\n\n\t/**\n\t * Returns the last element of the set wrapped in a new `shoestring` object.\n\t *\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.last = function(){\n\t\treturn this.eq( this.length - 1 );\n\t};\n\n\n\n\t/**\n\t * Returns a `shoestring` object with the set of siblings of each element in the original set.\n\t *\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.next = function(){\n\t\t\n\t\tvar result = [];\n\n\t\t// TODO need to implement map\n\t\tthis.each(function() {\n\t\t\tvar children, item, found;\n\n\t\t\t// get the child nodes for this member of the set\n\t\t\tchildren = shoestring( this.parentNode )[0].childNodes;\n\n\t\t\tfor( var i = 0; i < children.length; i++ ){\n\t\t\t\titem = children.item( i );\n\n\t\t\t\t// found the item we needed (found) which means current item value is\n\t\t\t\t// the next node in the list, as long as it's viable grab it\n\t\t\t\t// NOTE may need to be more permissive\n\t\t\t\tif( found && item.nodeType === 1 ){\n\t\t\t\t\tresult.push( item );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t// find the current item and mark it as found\n\t\t\t\tif( item === this ){\n\t\t\t\t\tfound = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn shoestring( result );\n\t};\n\n\n\n\t/**\n\t * Removes elements from the current set.\n\t *\n\t * @param {string} selector The selector to use when removing the elements.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.not = function( selector ){\n\t\tvar ret = [];\n\n\t\tthis.each(function(){\n\t\t\tvar found = shoestring( selector, this.parentNode );\n\n\t\t\tif( shoestring.inArray(this, found) === -1 ){\n\t\t\t\tret.push( this );\n\t\t\t}\n\t\t});\n\n\t\treturn shoestring( ret );\n\t};\n\n\n\n\t/**\n\t * Returns the set of first parents for each element in the current set.\n\t *\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.parent = function(){\n\t\tvar ret = [],\n\t\t\tparent;\n\n\t\tthis.each(function(){\n\t\t\t// no parent node, assume top level\n\t\t\t// jQuery parent: return the document object for <html> or the parent node if it exists\n\t\t\tparent = (this === doc.documentElement ? doc : this.parentNode);\n\n\t\t\t// if there is a parent and it's not a document fragment\n\t\t\tif( parent && parent.nodeType !== 11 ){\n\t\t\t\tret.push( parent );\n\t\t\t}\n\t\t});\n\n\t\treturn shoestring(ret);\n\t};\n\n\n\n\t/**\n\t * Add an HTML string or element before the children of each element in the current set.\n\t *\n\t * @param {string|HTMLElement} fragment The HTML string or element to add.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.prepend = function( fragment ){\n\t\tif( typeof( fragment ) === \"string\" || fragment.nodeType !== undefined ){\n\t\t\tfragment = shoestring( fragment );\n\t\t}\n\n\t\treturn this.each(function( i ){\n\n\t\t\tfor( var j = 0, jl = fragment.length; j < jl; j++ ){\n\t\t\t\tvar insertEl = i > 0 ? fragment[ j ].cloneNode( true ) : fragment[ j ];\n\t\t\t\tif ( this.firstChild ){\n\t\t\t\t\tthis.insertBefore( insertEl, this.firstChild );\n\t\t\t\t} else {\n\t\t\t\t\tthis.appendChild( insertEl );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\n\n\t/**\n\t * Returns a `shoestring` object with the set of *one* siblingx before each element in the original set.\n\t *\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.prev = function(){\n\t\t\n\t\tvar result = [];\n\n\t\t// TODO need to implement map\n\t\tthis.each(function() {\n\t\t\tvar children, item, found;\n\n\t\t\t// get the child nodes for this member of the set\n\t\t\tchildren = shoestring( this.parentNode )[0].childNodes;\n\n\t\t\tfor( var i = children.length -1; i >= 0; i-- ){\n\t\t\t\titem = children.item( i );\n\n\t\t\t\t// found the item we needed (found) which means current item value is\n\t\t\t\t// the next node in the list, as long as it's viable grab it\n\t\t\t\t// NOTE may need to be more permissive\n\t\t\t\tif( found && item.nodeType === 1 ){\n\t\t\t\t\tresult.push( item );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t// find the current item and mark it as found\n\t\t\t\tif( item === this ){\n\t\t\t\t\tfound = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn shoestring( result );\n\t};\n\n\n\n\t/**\n\t * Returns a `shoestring` object with the set of *all* siblings before each element in the original set.\n\t *\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.prevAll = function(){\n\t\t\n\t\tvar result = [];\n\n\t\tthis.each(function() {\n\t\t\tvar $previous = shoestring( this ).prev();\n\n\t\t\twhile( $previous.length ){\n\t\t\t\tresult.push( $previous[0] );\n\t\t\t\t$previous = $previous.prev();\n\t\t\t}\n\t\t});\n\n\t\treturn shoestring( result );\n\t};\n\n\n\n\t/**\n\t * Remove an attribute from each element in the current set.\n\t *\n\t * @param {string} name The name of the attribute.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.removeAttr = function( name ){\n\t\treturn this.each(function(){\n\t\t\tthis.removeAttribute( name );\n\t\t});\n\t};\n\n\n\n\t/**\n\t * Remove a class from each DOM element in the set of elements.\n\t *\n\t * @param {string} className The name of the class to be removed.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.removeClass = function( cname ){\n\t\tvar classes = cname.replace(/^\\s+|\\s+$/g, '').split( \" \" );\n\n\t\treturn this.each(function(){\n\t\t\tvar newClassName, regex;\n\n\t\t\tfor( var i = 0, il = classes.length; i < il; i++ ){\n\t\t\t\tif( this.className !== undefined ){\n\t\t\t\t\tregex = new RegExp( \"(^|\\\\s)\" + classes[ i ] + \"($|\\\\s)\", \"gmi\" );\n\t\t\t\t\tnewClassName = this.className.replace( regex, \" \" );\n\n\t\t\t\t\tthis.className = newClassName.replace(/^\\s+|\\s+$/g, '');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\n\n\t/**\n\t * Remove the current set of elements from the DOM.\n\t *\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.remove = function(){\n\t\treturn this.each(function(){\n\t\t\tif( this.parentNode ) {\n\t\t\t\tthis.parentNode.removeChild( this );\n\t\t\t}\n\t\t});\n\t};\n\n\n\n\t/**\n\t * Replace each element in the current set with that argument HTML string or HTMLElement.\n\t *\n\t * @param {string|HTMLElement} fragment The value to assign.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.replaceWith = function( fragment ){\n\t\tif( typeof( fragment ) === \"string\" ){\n\t\t\tfragment = shoestring( fragment );\n\t\t}\n\n\t\tvar ret = [];\n\n\t\tif( fragment.length > 1 ){\n\t\t\tfragment = fragment.reverse();\n\t\t}\n\t\tthis.each(function( i ){\n\t\t\tvar clone = this.cloneNode( true ),\n\t\t\t\tinsertEl;\n\t\t\tret.push( clone );\n\n\t\t\t// If there is no parentNode, this is pointless, drop it.\n\t\t\tif( !this.parentNode ){ return; }\n\n\t\t\tif( fragment.length === 1 ){\n\t\t\t\tinsertEl = i > 0 ? fragment[ 0 ].cloneNode( true ) : fragment[ 0 ];\n\t\t\t\tthis.parentNode.replaceChild( insertEl, this );\n\t\t\t} else {\n\t\t\t\tfor( var j = 0, jl = fragment.length; j < jl; j++ ){\n\t\t\t\t\tinsertEl = i > 0 ? fragment[ j ].cloneNode( true ) : fragment[ j ];\n\t\t\t\t\tthis.parentNode.insertBefore( insertEl, this.nextSibling );\n\t\t\t\t}\n\t\t\t\tthis.parentNode.removeChild( this );\n\t\t\t}\n\t\t});\n\n\t\treturn shoestring( ret );\n\t};\n\n\n\n  /**\n\t * Get all of the sibling elements for each element in the current set.\n\t *\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.siblings = function(){\n\t\t\n\t\tif( !this.length ) {\n\t\t\treturn shoestring( [] );\n\t\t}\n\n\t\tvar sibs = [], el = this[ 0 ].parentNode.firstChild;\n\n\t\tdo {\n\t\t\tif( el.nodeType === 1 && el !== this[ 0 ] ) {\n\t\t\t\tsibs.push( el );\n\t\t\t}\n\n      el = el.nextSibling;\n\t\t} while( el );\n\n\t\treturn shoestring( sibs );\n\t};\n\n\n\n\tvar getText = function( elem ){\n\t\tvar node,\n\t\t\tret = \"\",\n\t\t\ti = 0,\n\t\t\tnodeType = elem.nodeType;\n\n\t\tif ( !nodeType ) {\n\t\t\t// If no nodeType, this is expected to be an array\n\t\t\twhile ( (node = elem[i++]) ) {\n\t\t\t\t// Do not traverse comment nodes\n\t\t\t\tret += getText( node );\n\t\t\t}\n\t\t} else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {\n\t\t\t// Use textContent for elements\n\t\t\t// innerText usage removed for consistency of new lines (jQuery #11153)\n\t\t\tif ( typeof elem.textContent === \"string\" ) {\n\t\t\t\treturn elem.textContent;\n\t\t\t} else {\n\t\t\t\t// Traverse its children\n\t\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n\t\t\t\t\tret += getText( elem );\n\t\t\t\t}\n\t\t\t}\n\t\t} else if ( nodeType === 3 || nodeType === 4 ) {\n\t\t\treturn elem.nodeValue;\n\t\t}\n\t\t// Do not include comment or processing instruction nodes\n\n\t\treturn ret;\n\t};\n\n  /**\n\t * Recursively retrieve the text content of the each element in the current set.\n\t *\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.text = function() {\n\t\t\n\t\treturn getText( this );\n\t};\n\n\n\n\n\t/**\n\t * Get the value of the first element or set the value of all elements in the current set.\n\t *\n\t * @param {string} value The value to set.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.val = function( value ){\n\t\tvar el;\n\t\tif( value !== undefined ){\n\t\t\treturn this.each(function(){\n\t\t\t\tif( this.tagName === \"SELECT\" ){\n\t\t\t\t\tvar optionSet, option,\n\t\t\t\t\t\toptions = this.options,\n\t\t\t\t\t\tvalues = [],\n\t\t\t\t\t\ti = options.length,\n\t\t\t\t\t\tnewIndex;\n\n\t\t\t\t\tvalues[0] = value;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\toption = options[ i ];\n\t\t\t\t\t\tif ( (option.selected = shoestring.inArray( option.value, values ) >= 0) ) {\n\t\t\t\t\t\t\toptionSet = true;\n\t\t\t\t\t\t\tnewIndex = i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// force browsers to behave consistently when non-matching value is set\n\t\t\t\t\tif ( !optionSet ) {\n\t\t\t\t\t\tthis.selectedIndex = -1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.selectedIndex = newIndex;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.value = value;\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tel = this[0];\n\n\t\t\tif( el.tagName === \"SELECT\" ){\n\t\t\t\tif( el.selectedIndex < 0 ){ return \"\"; }\n\t\t\t\treturn el.options[ el.selectedIndex ].value;\n\t\t\t} else {\n\t\t\t\treturn el.value;\n\t\t\t}\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Private function for setting/getting the offset property for height/width.\n\t *\n\t * **NOTE** Please use the [width](width.js.html) or [height](height.js.html) methods instead.\n\t *\n\t * @param {shoestring} set The set of elements.\n\t * @param {string} name The string \"height\" or \"width\".\n\t * @param {float|undefined} value The value to assign.\n\t * @return shoestring\n\t * @this window\n\t */\n\tshoestring._dimension = function( set, name, value ){\n\t\tvar offsetName;\n\n\t\tif( value === undefined ){\n\t\t\toffsetName = name.replace(/^[a-z]/, function( letter ) {\n\t\t\t\treturn letter.toUpperCase();\n\t\t\t});\n\n\t\t\treturn set[ 0 ][ \"offset\" + offsetName ];\n\t\t} else {\n\t\t\t// support integer values as pixels\n\t\t\tvalue = typeof value === \"string\" ? value : value + \"px\";\n\n\t\t\treturn set.each(function(){\n\t\t\t\tthis.style[ name ] = value;\n\t\t\t});\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Gets the width value of the first element or sets the width for the whole set.\n\t *\n\t * @param {float|undefined} value The value to assign.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.width = function( value ){\n\t\treturn shoestring._dimension( this, \"width\", value );\n\t};\n\n\n\n\t/**\n\t * Wraps the child elements in the provided HTML.\n\t *\n\t * @param {string} html The wrapping HTML.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.wrapInner = function( html ){\n\t\treturn this.each(function(){\n\t\t\tvar inH = this.innerHTML;\n\n\t\t\tthis.innerHTML = \"\";\n\t\t\tshoestring( this ).append( shoestring( html ).html( inH ) );\n\t\t});\n\t};\n\n\n\n\tfunction initEventCache( el, evt ) {\n\t\tif ( !el.shoestringData ) {\n\t\t\tel.shoestringData = {};\n\t\t}\n\t\tif ( !el.shoestringData.events ) {\n\t\t\tel.shoestringData.events = {};\n\t\t}\n\t\tif ( !el.shoestringData.loop ) {\n\t\t\tel.shoestringData.loop = {};\n\t\t}\n\t\tif ( !el.shoestringData.events[ evt ] ) {\n\t\t\tel.shoestringData.events[ evt ] = [];\n\t\t}\n\t}\n\n\tfunction addToEventCache( el, evt, eventInfo ) {\n\t\tvar obj = {};\n\t\tobj.isCustomEvent = eventInfo.isCustomEvent;\n\t\tobj.callback = eventInfo.callfunc;\n\t\tobj.originalCallback = eventInfo.originalCallback;\n\t\tobj.namespace = eventInfo.namespace;\n\n\t\tel.shoestringData.events[ evt ].push( obj );\n\n\t\tif( eventInfo.customEventLoop ) {\n\t\t\tel.shoestringData.loop[ evt ] = eventInfo.customEventLoop;\n\t\t}\n\t}\n\n\t/**\n\t * Bind a callback to an event for the currrent set of elements.\n\t *\n\t * @param {string} evt The event(s) to watch for.\n\t * @param {object,function} data Data to be included with each event or the callback.\n\t * @param {function} originalCallback Callback to be invoked when data is define.d.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.bind = function( evt, data, originalCallback ){\n\n\t\t\t\tif( typeof data === \"function\" ){\n\t\t\toriginalCallback = data;\n\t\t\tdata = null;\n\t\t}\n\n\t\tvar evts = evt.split( \" \" );\n\n\t\t// NOTE the `triggeredElement` is purely for custom events from IE\n\t\tfunction encasedCallback( e, namespace, triggeredElement ){\n\t\t\tvar result;\n\n\t\t\tif( e._namespace && e._namespace !== namespace ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\te.data = data;\n\t\t\te.namespace = e._namespace;\n\n\t\t\tvar returnTrue = function(){\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\te.isDefaultPrevented = function(){\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tvar originalPreventDefault = e.preventDefault;\n\t\t\tvar preventDefaultConstructor = function(){\n\t\t\t\tif( originalPreventDefault ) {\n\t\t\t\t\treturn function(){\n\t\t\t\t\t\te.isDefaultPrevented = returnTrue;\n\t\t\t\t\t\toriginalPreventDefault.call(e);\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\treturn function(){\n\t\t\t\t\t\te.isDefaultPrevented = returnTrue;\n\t\t\t\t\t\te.returnValue = false;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// thanks https://github.com/jonathantneal/EventListener\n\t\t\te.target = triggeredElement || e.target || e.srcElement;\n\t\t\te.preventDefault = preventDefaultConstructor();\n\t\t\te.stopPropagation = e.stopPropagation || function () {\n\t\t\t\te.cancelBubble = true;\n\t\t\t};\n\n\t\t\tresult = originalCallback.apply(this, [ e ].concat( e._args ) );\n\n\t\t\tif( result === false ){\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\treturn this.each(function(){\n\t\t\tvar domEventCallback,\n\t\t\t\tcustomEventCallback,\n\t\t\t\tcustomEventLoop,\n\t\t\t\toEl = this;\n\n\t\t\tfor( var i = 0, il = evts.length; i < il; i++ ){\n\t\t\t\tvar split = evts[ i ].split( \".\" ),\n\t\t\t\t\tevt = split[ 0 ],\n\t\t\t\t\tnamespace = split.length > 0 ? split[ 1 ] : null;\n\n\t\t\t\tdomEventCallback = function( originalEvent ) {\n\t\t\t\t\tif( oEl.ssEventTrigger ) {\n\t\t\t\t\t\toriginalEvent._namespace = oEl.ssEventTrigger._namespace;\n\t\t\t\t\t\toriginalEvent._args = oEl.ssEventTrigger._args;\n\n\t\t\t\t\t\toEl.ssEventTrigger = null;\n\t\t\t\t\t}\n\t\t\t\t\treturn encasedCallback.call( oEl, originalEvent, namespace );\n\t\t\t\t};\n\t\t\t\tcustomEventCallback = null;\n\t\t\t\tcustomEventLoop = null;\n\n\t\t\t\tinitEventCache( this, evt );\n\n\t\t\t\tthis.addEventListener( evt, domEventCallback, false );\n\n\t\t\t\taddToEventCache( this, evt, {\n\t\t\t\t\tcallfunc: customEventCallback || domEventCallback,\n\t\t\t\t\tisCustomEvent: !!customEventCallback,\n\t\t\t\t\tcustomEventLoop: customEventLoop,\n\t\t\t\t\toriginalCallback: originalCallback,\n\t\t\t\t\tnamespace: namespace\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\n\tshoestring.fn.on = shoestring.fn.bind;\n\n\t\n\n\n\t/**\n\t * Unbind a previous bound callback for an event.\n\t *\n\t * @param {string} event The event(s) the callback was bound to..\n\t * @param {function} callback Callback to unbind.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.unbind = function( event, callback ){\n\n\t\t\n\t\tvar evts = event ? event.split( \" \" ) : [];\n\n\t\treturn this.each(function(){\n\t\t\tif( !this.shoestringData || !this.shoestringData.events ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif( !evts.length ) {\n\t\t\t\tunbindAll.call( this );\n\t\t\t} else {\n\t\t\t\tvar split, evt, namespace;\n\t\t\t\tfor( var i = 0, il = evts.length; i < il; i++ ){\n\t\t\t\t\tsplit = evts[ i ].split( \".\" ),\n\t\t\t\t\tevt = split[ 0 ],\n\t\t\t\t\tnamespace = split.length > 0 ? split[ 1 ] : null;\n\n\t\t\t\t\tif( evt ) {\n\t\t\t\t\t\tunbind.call( this, evt, namespace, callback );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tunbindAll.call( this, namespace, callback );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\tfunction unbind( evt, namespace, callback ) {\n\t\tvar bound = this.shoestringData.events[ evt ];\n\t\tif( !(bound && bound.length) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar matched = [], j, jl;\n\t\tfor( j = 0, jl = bound.length; j < jl; j++ ) {\n\t\t\tif( !namespace || namespace === bound[ j ].namespace ) {\n\t\t\t\tif( callback === undefined || callback === bound[ j ].originalCallback ) {\n\t\t\t\t\tthis.removeEventListener( evt, bound[ j ].callback, false );\n\t\t\t\t\tmatched.push( j );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor( j = 0, jl = matched.length; j < jl; j++ ) {\n\t\t\tthis.shoestringData.events[ evt ].splice( j, 1 );\n\t\t}\n\t}\n\n\tfunction unbindAll( namespace, callback ) {\n\t\tfor( var evtKey in this.shoestringData.events ) {\n\t\t\tunbind.call( this, evtKey, namespace, callback );\n\t\t}\n\t}\n\n\tshoestring.fn.off = shoestring.fn.unbind;\n\n\n\t/**\n\t * Bind a callback to an event for the currrent set of elements, unbind after one occurence.\n\t *\n\t * @param {string} event The event(s) to watch for.\n\t * @param {function} callback Callback to invoke on the event.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.one = function( event, callback ){\n\t\tvar evts = event.split( \" \" );\n\n\t\treturn this.each(function(){\n\t\t\tvar thisevt, cbs = {},\t$t = shoestring( this );\n\n\t\t\tfor( var i = 0, il = evts.length; i < il; i++ ){\n\t\t\t\tthisevt = evts[ i ];\n\n\t\t\t\tcbs[ thisevt ] = function( e ){\n\t\t\t\t\tvar $t = shoestring( this );\n\n\t\t\t\t\tfor( var j in cbs ) {\n\t\t\t\t\t\t$t.unbind( j, cbs[ j ] );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn callback.apply( this, [ e ].concat( e._args ) );\n\t\t\t\t};\n\n\t\t\t\t$t.bind( thisevt, cbs[ thisevt ] );\n\t\t\t}\n\t\t});\n\t};\n\n\n\n\t/**\n\t * Trigger an event on the first element in the set, no bubbling, no defaults.\n\t *\n\t * @param {string} event The event(s) to trigger.\n\t * @param {object} args Arguments to append to callback invocations.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.triggerHandler = function( event, args ){\n\t\tvar e = event.split( \" \" )[ 0 ],\n\t\t\tel = this[ 0 ],\n\t\t\tret;\n\n\t\t// See this.fireEvent( 'on' + evts[ i ], document.createEventObject() ); instead of click() etc in trigger.\n\t\tif( doc.createEvent && el.shoestringData && el.shoestringData.events && el.shoestringData.events[ e ] ){\n\t\t\tvar bindings = el.shoestringData.events[ e ];\n\t\t\tfor (var i in bindings ){\n\t\t\t\tif( bindings.hasOwnProperty( i ) ){\n\t\t\t\t\tevent = doc.createEvent( \"Event\" );\n\t\t\t\t\tevent.initEvent( e, true, true );\n\t\t\t\t\tevent._args = args;\n\t\t\t\t\targs.unshift( event );\n\n\t\t\t\t\tret = bindings[ i ].originalCallback.apply( event.target, args );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t};\n\n\n\n\t/**\n\t * Trigger an event on each of the DOM elements in the current set.\n\t *\n\t * @param {string} event The event(s) to trigger.\n\t * @param {object} args Arguments to append to callback invocations.\n\t * @return shoestring\n\t * @this shoestring\n\t */\n\tshoestring.fn.trigger = function( event, args ){\n\t\tvar evts = event.split( \" \" );\n\n\t\treturn this.each(function(){\n\t\t\tvar split, evt, namespace;\n\t\t\tfor( var i = 0, il = evts.length; i < il; i++ ){\n\t\t\t\tsplit = evts[ i ].split( \".\" ),\n\t\t\t\tevt = split[ 0 ],\n\t\t\t\tnamespace = split.length > 0 ? split[ 1 ] : null;\n\n\t\t\t\tif( evt === \"click\" ){\n\t\t\t\t\tif( this.tagName === \"INPUT\" && this.type === \"checkbox\" && this.click ){\n\t\t\t\t\t\tthis.click();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif( doc.createEvent ){\n\t\t\t\t\tvar event = doc.createEvent( \"Event\" );\n\t\t\t\t\tevent.initEvent( evt, true, true );\n\t\t\t\t\tevent._args = args;\n\t\t\t\t\tevent._namespace = namespace;\n\n\t\t\t\t\tthis.dispatchEvent( event );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\n\n\treturn shoestring;\n}));\n\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([\"shoestring\"], function (shoestring) {\n      return (root.Tablesaw = factory(shoestring, root));\n    });\n  } else if (typeof exports === 'object') {\n    module.exports = factory(require('shoestring'), root);\n  } else {\n    root.Tablesaw = factory(shoestring, root);\n  }\n}(typeof window !== \"undefined\" ? window : this, function ($, window) {\n\t\"use strict\";\n\n  var document = window.document;\nvar domContentLoadedTriggered = false;\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n\tdomContentLoadedTriggered = true;\n});\n\nvar Tablesaw = {\n\ti18n: {\n\t\tmodeStack: \"Stack\",\n\t\tmodeSwipe: \"Swipe\",\n\t\tmodeToggle: \"Toggle\",\n\t\tmodeSwitchColumnsAbbreviated: \"Cols\",\n\t\tmodeSwitchColumns: \"Columns\",\n\t\tcolumnToggleButton: \"Columns\",\n\t\tcolumnToggleError: \"No eligible columns.\",\n\t\tsort: \"Sort\",\n\t\tswipePreviousColumn: \"Previous column\",\n\t\tswipeNextColumn: \"Next column\"\n\t},\n\t// cut the mustard\n\tmustard:\n\t\t\"head\" in document && // IE9+, Firefox 4+, Safari 5.1+, Mobile Safari 4.1+, Opera 11.5+, Android 2.3+\n\t\t(!window.blackberry || window.WebKitPoint) && // only WebKit Blackberry (OS 6+)\n\t\t!window.operamini,\n\t$: $,\n\t_init: function(element) {\n\t\tTablesaw.$(element || document).trigger(\"enhance.tablesaw\");\n\t},\n\tinit: function(element) {\n\t\tif (!domContentLoadedTriggered) {\n\t\t\tif (\"addEventListener\" in document) {\n\t\t\t\t// Use raw DOMContentLoaded instead of shoestring (may have issues in Android 2.3, exhibited by stack table)\n\t\t\t\tdocument.addEventListener(\"DOMContentLoaded\", function() {\n\t\t\t\t\tTablesaw._init(element);\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tTablesaw._init(element);\n\t\t}\n\t}\n};\n\n$(document).on(\"enhance.tablesaw\", function() {\n\t// Extend i18n config, if one exists.\n\tif (typeof TablesawConfig !== \"undefined\" && TablesawConfig.i18n) {\n\t\tTablesaw.i18n = $.extend(Tablesaw.i18n, TablesawConfig.i18n || {});\n\t}\n\n\tTablesaw.i18n.modes = [\n\t\tTablesaw.i18n.modeStack,\n\t\tTablesaw.i18n.modeSwipe,\n\t\tTablesaw.i18n.modeToggle\n\t];\n});\n\nif (Tablesaw.mustard) {\n\t$(document.documentElement).addClass(\"tablesaw-enhanced\");\n}\n\n(function() {\n\tvar pluginName = \"tablesaw\";\n\tvar classes = {\n\t\ttoolbar: \"tablesaw-bar\"\n\t};\n\tvar events = {\n\t\tcreate: \"tablesawcreate\",\n\t\tdestroy: \"tablesawdestroy\",\n\t\trefresh: \"tablesawrefresh\",\n\t\tresize: \"tablesawresize\"\n\t};\n\tvar defaultMode = \"stack\";\n\tvar initSelector = \"table\";\n\tvar initFilterSelector = \"[data-tablesaw],[data-tablesaw-mode],[data-tablesaw-sortable]\";\n\tvar defaultConfig = {};\n\n\tTablesaw.events = events;\n\n\tvar Table = function(element) {\n\t\tif (!element) {\n\t\t\tthrow new Error(\"Tablesaw requires an element.\");\n\t\t}\n\n\t\tthis.table = element;\n\t\tthis.$table = $(element);\n\n\t\t// only one <thead> and <tfoot> are allowed, per the specification\n\t\tthis.$thead = this.$table\n\t\t\t.children()\n\t\t\t.filter(\"thead\")\n\t\t\t.eq(0);\n\n\t\t// multiple <tbody> are allowed, per the specification\n\t\tthis.$tbody = this.$table.children().filter(\"tbody\");\n\n\t\tthis.mode = this.$table.attr(\"data-tablesaw-mode\") || defaultMode;\n\n\t\tthis.$toolbar = null;\n\n\t\tthis.attributes = {\n\t\t\tsubrow: \"data-tablesaw-subrow\",\n\t\t\tignorerow: \"data-tablesaw-ignorerow\"\n\t\t};\n\n\t\tthis.init();\n\t};\n\n\tTable.prototype.init = function() {\n\t\tif (!this.$thead.length) {\n\t\t\tthrow new Error(\"tablesaw: a <thead> is required, but none was found.\");\n\t\t}\n\n\t\tif (!this.$thead.find(\"th\").length) {\n\t\t\tthrow new Error(\"tablesaw: no header cells found. Are you using <th> inside of <thead>?\");\n\t\t}\n\n\t\t// assign an id if there is none\n\t\tif (!this.$table.attr(\"id\")) {\n\t\t\tthis.$table.attr(\"id\", pluginName + \"-\" + Math.round(Math.random() * 10000));\n\t\t}\n\n\t\tthis.createToolbar();\n\n\t\tthis._initCells();\n\n\t\tthis.$table.data(pluginName, this);\n\n\t\tthis.$table.trigger(events.create, [this]);\n\t};\n\n\tTable.prototype.getConfig = function(pluginSpecificConfig) {\n\t\t// shoestring extend doesnt support arbitrary args\n\t\tvar configs = $.extend(defaultConfig, pluginSpecificConfig || {});\n\t\treturn $.extend(configs, typeof TablesawConfig !== \"undefined\" ? TablesawConfig : {});\n\t};\n\n\tTable.prototype._getPrimaryHeaderRow = function() {\n\t\treturn this._getHeaderRows().eq(0);\n\t};\n\n\tTable.prototype._getHeaderRows = function() {\n\t\treturn this.$thead\n\t\t\t.children()\n\t\t\t.filter(\"tr\")\n\t\t\t.filter(function() {\n\t\t\t\treturn !$(this).is(\"[data-tablesaw-ignorerow]\");\n\t\t\t});\n\t};\n\n\tTable.prototype._getRowIndex = function($row) {\n\t\treturn $row.prevAll().length;\n\t};\n\n\tTable.prototype._getHeaderRowIndeces = function() {\n\t\tvar self = this;\n\t\tvar indeces = [];\n\t\tthis._getHeaderRows().each(function() {\n\t\t\tindeces.push(self._getRowIndex($(this)));\n\t\t});\n\t\treturn indeces;\n\t};\n\n\tTable.prototype._getPrimaryHeaderCells = function($row) {\n\t\treturn ($row || this._getPrimaryHeaderRow()).find(\"th\");\n\t};\n\n\tTable.prototype._$getCells = function(th) {\n\t\tvar self = this;\n\t\treturn $(th)\n\t\t\t.add(th.cells)\n\t\t\t.filter(function() {\n\t\t\t\tvar $t = $(this);\n\t\t\t\tvar $row = $t.parent();\n\t\t\t\tvar hasColspan = $t.is(\"[colspan]\");\n\t\t\t\t// no subrows or ignored rows (keep cells in ignored rows that do not have a colspan)\n\t\t\t\treturn (\n\t\t\t\t\t!$row.is(\"[\" + self.attributes.subrow + \"]\") &&\n\t\t\t\t\t(!$row.is(\"[\" + self.attributes.ignorerow + \"]\") || !hasColspan)\n\t\t\t\t);\n\t\t\t});\n\t};\n\n\tTable.prototype._getVisibleColspan = function() {\n\t\tvar colspan = 0;\n\t\tthis._getPrimaryHeaderCells().each(function() {\n\t\t\tvar $t = $(this);\n\t\t\tif ($t.css(\"display\") !== \"none\") {\n\t\t\t\tcolspan += parseInt($t.attr(\"colspan\"), 10) || 1;\n\t\t\t}\n\t\t});\n\t\treturn colspan;\n\t};\n\n\tTable.prototype.getColspanForCell = function($cell) {\n\t\tvar visibleColspan = this._getVisibleColspan();\n\t\tvar visibleSiblingColumns = 0;\n\t\tif ($cell.closest(\"tr\").data(\"tablesaw-rowspanned\")) {\n\t\t\tvisibleSiblingColumns++;\n\t\t}\n\n\t\t$cell.siblings().each(function() {\n\t\t\tvar $t = $(this);\n\t\t\tvar colColspan = parseInt($t.attr(\"colspan\"), 10) || 1;\n\n\t\t\tif ($t.css(\"display\") !== \"none\") {\n\t\t\t\tvisibleSiblingColumns += colColspan;\n\t\t\t}\n\t\t});\n\t\t// console.log( $cell[ 0 ], visibleColspan, visibleSiblingColumns );\n\n\t\treturn visibleColspan - visibleSiblingColumns;\n\t};\n\n\tTable.prototype.isCellInColumn = function(header, cell) {\n\t\treturn $(header)\n\t\t\t.add(header.cells)\n\t\t\t.filter(function() {\n\t\t\t\treturn this === cell;\n\t\t\t}).length;\n\t};\n\n\tTable.prototype.updateColspanCells = function(cls, header, userAction) {\n\t\tvar self = this;\n\t\tvar primaryHeaderRow = self._getPrimaryHeaderRow();\n\n\t\t// find persistent column rowspans\n\t\tthis.$table.find(\"[rowspan][data-tablesaw-priority]\").each(function() {\n\t\t\tvar $t = $(this);\n\t\t\tif ($t.attr(\"data-tablesaw-priority\") !== \"persist\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar $row = $t.closest(\"tr\");\n\t\t\tvar rowspan = parseInt($t.attr(\"rowspan\"), 10);\n\t\t\tif (rowspan > 1) {\n\t\t\t\t$row = $row.next();\n\n\t\t\t\t$row.data(\"tablesaw-rowspanned\", true);\n\n\t\t\t\trowspan--;\n\t\t\t}\n\t\t});\n\n\t\tthis.$table\n\t\t\t.find(\"[colspan],[data-tablesaw-maxcolspan]\")\n\t\t\t.filter(function() {\n\t\t\t\t// is not in primary header row\n\t\t\t\treturn $(this).closest(\"tr\")[0] !== primaryHeaderRow[0];\n\t\t\t})\n\t\t\t.each(function() {\n\t\t\t\tvar $cell = $(this);\n\n\t\t\t\tif (userAction === undefined || self.isCellInColumn(header, this)) {\n\t\t\t\t} else {\n\t\t\t\t\t// if is not a user action AND the cell is not in the updating column, kill it\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar colspan = self.getColspanForCell($cell);\n\n\t\t\t\tif (cls && userAction !== undefined) {\n\t\t\t\t\t// console.log( colspan === 0 ? \"addClass\" : \"removeClass\", $cell );\n\t\t\t\t\t$cell[colspan === 0 ? \"addClass\" : \"removeClass\"](cls);\n\t\t\t\t}\n\n\t\t\t\t// cache original colspan\n\t\t\t\tvar maxColspan = parseInt($cell.attr(\"data-tablesaw-maxcolspan\"), 10);\n\t\t\t\tif (!maxColspan) {\n\t\t\t\t\t$cell.attr(\"data-tablesaw-maxcolspan\", $cell.attr(\"colspan\"));\n\t\t\t\t} else if (colspan > maxColspan) {\n\t\t\t\t\tcolspan = maxColspan;\n\t\t\t\t}\n\n\t\t\t\t// console.log( this, \"setting colspan to \", colspan );\n\t\t\t\t$cell.attr(\"colspan\", colspan);\n\t\t\t});\n\t};\n\n\tTable.prototype._findPrimaryHeadersForCell = function(cell) {\n\t\tvar $headerRow = this._getPrimaryHeaderRow();\n\t\tvar $headers = this._getPrimaryHeaderCells($headerRow);\n\t\tvar headerRowIndex = this._getRowIndex($headerRow);\n\t\tvar results = [];\n\n\t\tfor (var rowNumber = 0; rowNumber < this.headerMapping.length; rowNumber++) {\n\t\t\tif (rowNumber === headerRowIndex) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor (var colNumber = 0; colNumber < this.headerMapping[rowNumber].length; colNumber++) {\n\t\t\t\tif (this.headerMapping[rowNumber][colNumber] === cell) {\n\t\t\t\t\tresults.push($headers[colNumber]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t};\n\n\t// used by init cells\n\tTable.prototype.getRows = function() {\n\t\tvar self = this;\n\t\treturn this.$table.find(\"tr\").filter(function() {\n\t\t\treturn $(this)\n\t\t\t\t.closest(\"table\")\n\t\t\t\t.is(self.$table);\n\t\t});\n\t};\n\n\t// used by sortable\n\tTable.prototype.getBodyRows = function(tbody) {\n\t\treturn (tbody ? $(tbody) : this.$tbody).children().filter(\"tr\");\n\t};\n\n\tTable.prototype.getHeaderCellIndex = function(cell) {\n\t\tvar lookup = this.headerMapping[0];\n\t\tfor (var colIndex = 0; colIndex < lookup.length; colIndex++) {\n\t\t\tif (lookup[colIndex] === cell) {\n\t\t\t\treturn colIndex;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t};\n\n\tTable.prototype._initCells = function() {\n\t\t// re-establish original colspans\n\t\tthis.$table.find(\"[data-tablesaw-maxcolspan]\").each(function() {\n\t\t\tvar $t = $(this);\n\t\t\t$t.attr(\"colspan\", $t.attr(\"data-tablesaw-maxcolspan\"));\n\t\t});\n\n\t\tvar $rows = this.getRows();\n\t\tvar columnLookup = [];\n\n\t\t$rows.each(function(rowNumber) {\n\t\t\tcolumnLookup[rowNumber] = [];\n\t\t});\n\n\t\t$rows.each(function(rowNumber) {\n\t\t\tvar coltally = 0;\n\t\t\tvar $t = $(this);\n\t\t\tvar children = $t.children();\n\n\t\t\tchildren.each(function() {\n\t\t\t\tvar colspan = parseInt(\n\t\t\t\t\tthis.getAttribute(\"data-tablesaw-maxcolspan\") || this.getAttribute(\"colspan\"),\n\t\t\t\t\t10\n\t\t\t\t);\n\t\t\t\tvar rowspan = parseInt(this.getAttribute(\"rowspan\"), 10);\n\n\t\t\t\t// set in a previous rowspan\n\t\t\t\twhile (columnLookup[rowNumber][coltally]) {\n\t\t\t\t\tcoltally++;\n\t\t\t\t}\n\n\t\t\t\tcolumnLookup[rowNumber][coltally] = this;\n\n\t\t\t\t// TODO? both colspan and rowspan\n\t\t\t\tif (colspan) {\n\t\t\t\t\tfor (var k = 0; k < colspan - 1; k++) {\n\t\t\t\t\t\tcoltally++;\n\t\t\t\t\t\tcolumnLookup[rowNumber][coltally] = this;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (rowspan) {\n\t\t\t\t\tfor (var j = 1; j < rowspan; j++) {\n\t\t\t\t\t\tcolumnLookup[rowNumber + j][coltally] = this;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcoltally++;\n\t\t\t});\n\t\t});\n\n\t\tvar headerRowIndeces = this._getHeaderRowIndeces();\n\t\tfor (var colNumber = 0; colNumber < columnLookup[0].length; colNumber++) {\n\t\t\tfor (var headerIndex = 0, k = headerRowIndeces.length; headerIndex < k; headerIndex++) {\n\t\t\t\tvar headerCol = columnLookup[headerRowIndeces[headerIndex]][colNumber];\n\n\t\t\t\tvar rowNumber = headerRowIndeces[headerIndex];\n\t\t\t\tvar rowCell;\n\n\t\t\t\tif (!headerCol.cells) {\n\t\t\t\t\theaderCol.cells = [];\n\t\t\t\t}\n\n\t\t\t\twhile (rowNumber < columnLookup.length) {\n\t\t\t\t\trowCell = columnLookup[rowNumber][colNumber];\n\n\t\t\t\t\tif (headerCol !== rowCell) {\n\t\t\t\t\t\theaderCol.cells.push(rowCell);\n\t\t\t\t\t}\n\n\t\t\t\t\trowNumber++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.headerMapping = columnLookup;\n\t};\n\n\tTable.prototype.refresh = function() {\n\t\tthis._initCells();\n\n\t\tthis.$table.trigger(events.refresh, [this]);\n\t};\n\n\tTable.prototype._getToolbarAnchor = function() {\n\t\tvar $parent = this.$table.parent();\n\t\tif ($parent.is(\".tablesaw-overflow\")) {\n\t\t\treturn $parent;\n\t\t}\n\t\treturn this.$table;\n\t};\n\n\tTable.prototype._getToolbar = function($anchor) {\n\t\tif (!$anchor) {\n\t\t\t$anchor = this._getToolbarAnchor();\n\t\t}\n\t\treturn $anchor.prev().filter(\".\" + classes.toolbar);\n\t};\n\n\tTable.prototype.createToolbar = function() {\n\t\t// Insert the toolbar\n\t\t// TODO move this into a separate component\n\t\tvar $anchor = this._getToolbarAnchor();\n\t\tvar $toolbar = this._getToolbar($anchor);\n\t\tif (!$toolbar.length) {\n\t\t\t$toolbar = $(\"<div>\")\n\t\t\t\t.addClass(classes.toolbar)\n\t\t\t\t.insertBefore($anchor);\n\t\t}\n\t\tthis.$toolbar = $toolbar;\n\n\t\tif (this.mode) {\n\t\t\tthis.$toolbar.addClass(\"tablesaw-mode-\" + this.mode);\n\t\t}\n\t};\n\n\tTable.prototype.destroy = function() {\n\t\t// Dont remove the toolbar, just erase the classes on it.\n\t\t// Some of the table features are not yet destroy-friendly.\n\t\tthis._getToolbar().each(function() {\n\t\t\tthis.className = this.className.replace(/\\btablesaw-mode\\-\\w*\\b/gi, \"\");\n\t\t});\n\n\t\tvar tableId = this.$table.attr(\"id\");\n\t\t$(document).off(\".\" + tableId);\n\t\t$(window).off(\".\" + tableId);\n\n\t\t// other plugins\n\t\tthis.$table.trigger(events.destroy, [this]);\n\n\t\tthis.$table.removeData(pluginName);\n\t};\n\n\t// Collection method.\n\t$.fn[pluginName] = function() {\n\t\treturn this.each(function() {\n\t\t\tvar $t = $(this);\n\n\t\t\tif ($t.data(pluginName)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnew Table(this);\n\t\t});\n\t};\n\n\tvar $doc = $(document);\n\t$doc.on(\"enhance.tablesaw\", function(e) {\n\t\t// Cut the mustard\n\t\tif (Tablesaw.mustard) {\n\t\t\t$(e.target)\n\t\t\t\t.find(initSelector)\n\t\t\t\t.filter(initFilterSelector)\n\t\t\t\t[pluginName]();\n\t\t}\n\t});\n\n\t// Avoid a resize during scroll:\n\t// Some Mobile devices trigger a resize during scroll (sometimes when\n\t// doing elastic stretch at the end of the document or from the\n\t// location bar hide)\n\tvar isScrolling = false;\n\tvar scrollTimeout;\n\t$doc.on(\"scroll.tablesaw\", function() {\n\t\tisScrolling = true;\n\n\t\twindow.clearTimeout(scrollTimeout);\n\t\tscrollTimeout = window.setTimeout(function() {\n\t\t\tisScrolling = false;\n\t\t}, 300); // must be greater than the resize timeout below\n\t});\n\n\tvar resizeTimeout;\n\t$(window).on(\"resize\", function() {\n\t\tif (!isScrolling) {\n\t\t\twindow.clearTimeout(resizeTimeout);\n\t\t\tresizeTimeout = window.setTimeout(function() {\n\t\t\t\t$doc.trigger(events.resize);\n\t\t\t}, 150); // must be less than the scrolling timeout above.\n\t\t}\n\t});\n\n\tTablesaw.Table = Table;\n})();\n\n(function() {\n\tvar classes = {\n\t\tstackTable: \"tablesaw-stack\",\n\t\tcellLabels: \"tablesaw-cell-label\",\n\t\tcellContentLabels: \"tablesaw-cell-content\"\n\t};\n\n\tvar data = {\n\t\tkey: \"tablesaw-stack\"\n\t};\n\n\tvar attrs = {\n\t\tlabelless: \"data-tablesaw-no-labels\",\n\t\thideempty: \"data-tablesaw-hide-empty\"\n\t};\n\n\tvar Stack = function(element, tablesaw) {\n\t\tthis.tablesaw = tablesaw;\n\t\tthis.$table = $(element);\n\n\t\tthis.labelless = this.$table.is(\"[\" + attrs.labelless + \"]\");\n\t\tthis.hideempty = this.$table.is(\"[\" + attrs.hideempty + \"]\");\n\n\t\tthis.$table.data(data.key, this);\n\t};\n\n\tStack.prototype.init = function() {\n\t\tthis.$table.addClass(classes.stackTable);\n\n\t\tif (this.labelless) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar self = this;\n\n\t\tthis.$table\n\t\t\t.find(\"th, td\")\n\t\t\t.filter(function() {\n\t\t\t\treturn !$(this).closest(\"thead\").length;\n\t\t\t})\n\t\t\t.filter(function() {\n\t\t\t\treturn (\n\t\t\t\t\t!$(this)\n\t\t\t\t\t\t.closest(\"tr\")\n\t\t\t\t\t\t.is(\"[\" + attrs.labelless + \"]\") &&\n\t\t\t\t\t(!self.hideempty || !!$(this).html())\n\t\t\t\t);\n\t\t\t})\n\t\t\t.each(function() {\n\t\t\t\tvar $newHeader = $(document.createElement(\"b\")).addClass(classes.cellLabels);\n\t\t\t\tvar $cell = $(this);\n\n\t\t\t\t$(self.tablesaw._findPrimaryHeadersForCell(this)).each(function(index) {\n\t\t\t\t\tvar $header = $(this.cloneNode(true));\n\t\t\t\t\t// TODO decouple from sortable better\n\t\t\t\t\t// Changed from .text() in https://github.com/filamentgroup/tablesaw/commit/b9c12a8f893ec192830ec3ba2d75f062642f935b\n\t\t\t\t\t// to preserve structural html in headers, like <a>\n\t\t\t\t\tvar $sortableButton = $header.find(\".tablesaw-sortable-btn\");\n\t\t\t\t\t$header.find(\".tablesaw-sortable-arrow\").remove();\n\n\t\t\t\t\t// TODO decouple from checkall better\n\t\t\t\t\tvar $checkall = $header.find(\"[data-tablesaw-checkall]\");\n\t\t\t\t\t$checkall.closest(\"label\").remove();\n\t\t\t\t\tif ($checkall.length) {\n\t\t\t\t\t\t$newHeader = $([]);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (index > 0) {\n\t\t\t\t\t\t$newHeader.append(document.createTextNode(\", \"));\n\t\t\t\t\t}\n\n\t\t\t\t\tvar parentNode = $sortableButton.length ? $sortableButton[0] : $header[0];\n\t\t\t\t\tvar el;\n\t\t\t\t\twhile ((el = parentNode.firstChild)) {\n\t\t\t\t\t\t$newHeader[0].appendChild(el);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif ($newHeader.length && !$cell.find(\".\" + classes.cellContentLabels).length) {\n\t\t\t\t\t$cell.wrapInner(\"<span class='\" + classes.cellContentLabels + \"'></span>\");\n\t\t\t\t}\n\n\t\t\t\t// Update if already exists.\n\t\t\t\tvar $label = $cell.find(\".\" + classes.cellLabels);\n\t\t\t\tif (!$label.length) {\n\t\t\t\t\t$cell.prepend($newHeader);\n\t\t\t\t} else {\n\t\t\t\t\t// only if changed\n\t\t\t\t\t$label.replaceWith($newHeader);\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\tStack.prototype.destroy = function() {\n\t\tthis.$table.removeClass(classes.stackTable);\n\t\tthis.$table.find(\".\" + classes.cellLabels).remove();\n\t\tthis.$table.find(\".\" + classes.cellContentLabels).each(function() {\n\t\t\t$(this).replaceWith(this.childNodes);\n\t\t});\n\t};\n\n\t// on tablecreate, init\n\t$(document)\n\t\t.on(Tablesaw.events.create, function(e, tablesaw) {\n\t\t\tif (tablesaw.mode === \"stack\") {\n\t\t\t\tvar table = new Stack(tablesaw.table, tablesaw);\n\t\t\t\ttable.init();\n\t\t\t}\n\t\t})\n\t\t.on(Tablesaw.events.refresh, function(e, tablesaw) {\n\t\t\tif (tablesaw.mode === \"stack\") {\n\t\t\t\t$(tablesaw.table)\n\t\t\t\t\t.data(data.key)\n\t\t\t\t\t.init();\n\t\t\t}\n\t\t})\n\t\t.on(Tablesaw.events.destroy, function(e, tablesaw) {\n\t\t\tif (tablesaw.mode === \"stack\") {\n\t\t\t\t$(tablesaw.table)\n\t\t\t\t\t.data(data.key)\n\t\t\t\t\t.destroy();\n\t\t\t}\n\t\t});\n\n\tTablesaw.Stack = Stack;\n})();\n\n(function() {\n\tvar pluginName = \"tablesawbtn\",\n\t\tmethods = {\n\t\t\t_create: function() {\n\t\t\t\treturn $(this).each(function() {\n\t\t\t\t\t$(this)\n\t\t\t\t\t\t.trigger(\"beforecreate.\" + pluginName)\n\t\t\t\t\t\t[pluginName](\"_init\")\n\t\t\t\t\t\t.trigger(\"create.\" + pluginName);\n\t\t\t\t});\n\t\t\t},\n\t\t\t_init: function() {\n\t\t\t\tvar oEl = $(this),\n\t\t\t\t\tsel = this.getElementsByTagName(\"select\")[0];\n\n\t\t\t\tif (sel) {\n\t\t\t\t\t// TODO next major version: remove .btn-select\n\t\t\t\t\t$(this)\n\t\t\t\t\t\t.addClass(\"btn-select tablesaw-btn-select\")\n\t\t\t\t\t\t[pluginName](\"_select\", sel);\n\t\t\t\t}\n\t\t\t\treturn oEl;\n\t\t\t},\n\t\t\t_select: function(sel) {\n\t\t\t\tvar update = function(oEl, sel) {\n\t\t\t\t\tvar opts = $(sel).find(\"option\");\n\t\t\t\t\tvar label = document.createElement(\"span\");\n\t\t\t\t\tvar el;\n\t\t\t\t\tvar children;\n\t\t\t\t\tvar found = false;\n\n\t\t\t\t\tlabel.setAttribute(\"aria-hidden\", \"true\");\n\t\t\t\t\tlabel.innerHTML = \"&#160;\";\n\n\t\t\t\t\topts.each(function() {\n\t\t\t\t\t\tvar opt = this;\n\t\t\t\t\t\tif (opt.selected) {\n\t\t\t\t\t\t\tlabel.innerHTML = opt.text;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tchildren = oEl.childNodes;\n\t\t\t\t\tif (opts.length > 0) {\n\t\t\t\t\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\t\t\t\t\tel = children[i];\n\n\t\t\t\t\t\t\tif (el && el.nodeName.toUpperCase() === \"SPAN\") {\n\t\t\t\t\t\t\t\toEl.replaceChild(label, el);\n\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!found) {\n\t\t\t\t\t\t\toEl.insertBefore(label, oEl.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tupdate(this, sel);\n\t\t\t\t// todo should this be tablesawrefresh?\n\t\t\t\t$(this).on(\"change refresh\", function() {\n\t\t\t\t\tupdate(this, sel);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t// Collection method.\n\t$.fn[pluginName] = function(arrg, a, b, c) {\n\t\treturn this.each(function() {\n\t\t\t// if it's a method\n\t\t\tif (arrg && typeof arrg === \"string\") {\n\t\t\t\treturn $.fn[pluginName].prototype[arrg].call(this, a, b, c);\n\t\t\t}\n\n\t\t\t// don't re-init\n\t\t\tif ($(this).data(pluginName + \"active\")) {\n\t\t\t\treturn $(this);\n\t\t\t}\n\n\t\t\t$(this).data(pluginName + \"active\", true);\n\n\t\t\t$.fn[pluginName].prototype._create.call(this);\n\t\t});\n\t};\n\n\t// add methods\n\t$.extend($.fn[pluginName].prototype, methods);\n\n\t// TODO OOP this and add to Tablesaw object\n})();\n\n(function() {\n\tvar data = {\n\t\tkey: \"tablesaw-coltoggle\"\n\t};\n\n\tvar ColumnToggle = function(element) {\n\t\tthis.$table = $(element);\n\n\t\tif (!this.$table.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tablesaw = this.$table.data(\"tablesaw\");\n\n\t\tthis.attributes = {\n\t\t\tbtnTarget: \"data-tablesaw-columntoggle-btn-target\",\n\t\t\tset: \"data-tablesaw-columntoggle-set\"\n\t\t};\n\n\t\tthis.classes = {\n\t\t\tcolumnToggleTable: \"tablesaw-columntoggle\",\n\t\t\tcolumnBtnContain: \"tablesaw-columntoggle-btnwrap tablesaw-advance\",\n\t\t\tcolumnBtn: \"tablesaw-columntoggle-btn tablesaw-nav-btn down\",\n\t\t\tpopup: \"tablesaw-columntoggle-popup\",\n\t\t\tpriorityPrefix: \"tablesaw-priority-\"\n\t\t};\n\n\t\tthis.set = [];\n\t\tthis.$headers = this.tablesaw._getPrimaryHeaderCells();\n\n\t\tthis.$table.data(data.key, this);\n\t};\n\n\t// Column Toggle Sets (one column chooser can control multiple tables)\n\tColumnToggle.prototype.initSet = function() {\n\t\tvar set = this.$table.attr(this.attributes.set);\n\t\tif (set) {\n\t\t\t// Should not include the current table\n\t\t\tvar table = this.$table[0];\n\t\t\tthis.set = $(\"table[\" + this.attributes.set + \"='\" + set + \"']\")\n\t\t\t\t.filter(function() {\n\t\t\t\t\treturn this !== table;\n\t\t\t\t})\n\t\t\t\t.get();\n\t\t}\n\t};\n\n\tColumnToggle.prototype.init = function() {\n\t\tif (!this.$table.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar tableId,\n\t\t\tid,\n\t\t\t$menuButton,\n\t\t\t$popup,\n\t\t\t$menu,\n\t\t\t$btnContain,\n\t\t\tself = this;\n\n\t\tvar cfg = this.tablesaw.getConfig({\n\t\t\tgetColumnToggleLabelTemplate: function(text) {\n\t\t\t\treturn \"<label><input type='checkbox' checked>\" + text + \"</label>\";\n\t\t\t}\n\t\t});\n\n\t\tthis.$table.addClass(this.classes.columnToggleTable);\n\n\t\ttableId = this.$table.attr(\"id\");\n\t\tid = tableId + \"-popup\";\n\t\t$btnContain = $(\"<div class='\" + this.classes.columnBtnContain + \"'></div>\");\n\t\t// TODO next major version: remove .btn\n\t\t$menuButton = $(\n\t\t\t\"<a href='#\" +\n\t\t\t\tid +\n\t\t\t\t\"' class='btn tablesaw-btn btn-micro \" +\n\t\t\t\tthis.classes.columnBtn +\n\t\t\t\t\"' data-popup-link>\" +\n\t\t\t\t\"<span>\" +\n\t\t\t\tTablesaw.i18n.columnToggleButton +\n\t\t\t\t\"</span></a>\"\n\t\t);\n\t\t$popup = $(\"<div class='\" + this.classes.popup + \"' id='\" + id + \"'></div>\");\n\t\t$menu = $(\"<div class='btn-group'></div>\");\n\n\t\tthis.$popup = $popup;\n\n\t\tvar hasNonPersistentHeaders = false;\n\t\tthis.$headers.each(function() {\n\t\t\tvar $this = $(this),\n\t\t\t\tpriority = $this.attr(\"data-tablesaw-priority\"),\n\t\t\t\t$cells = self.tablesaw._$getCells(this);\n\n\t\t\tif (priority && priority !== \"persist\") {\n\t\t\t\t$cells.addClass(self.classes.priorityPrefix + priority);\n\n\t\t\t\t$(cfg.getColumnToggleLabelTemplate($this.text()))\n\t\t\t\t\t.appendTo($menu)\n\t\t\t\t\t.find('input[type=\"checkbox\"]')\n\t\t\t\t\t.data(\"tablesaw-header\", this);\n\n\t\t\t\thasNonPersistentHeaders = true;\n\t\t\t}\n\t\t});\n\n\t\tif (!hasNonPersistentHeaders) {\n\t\t\t$menu.append(\"<label>\" + Tablesaw.i18n.columnToggleError + \"</label>\");\n\t\t}\n\n\t\t$menu.appendTo($popup);\n\n\t\tfunction onToggleCheckboxChange(checkbox) {\n\t\t\tvar checked = checkbox.checked;\n\n\t\t\tvar header = self.getHeaderFromCheckbox(checkbox);\n\t\t\tvar $cells = self.tablesaw._$getCells(header);\n\n\t\t\t$cells[!checked ? \"addClass\" : \"removeClass\"](\"tablesaw-toggle-cellhidden\");\n\t\t\t$cells[checked ? \"addClass\" : \"removeClass\"](\"tablesaw-toggle-cellvisible\");\n\n\t\t\tself.updateColspanCells(header, checked);\n\n\t\t\tself.$table.trigger(\"tablesawcolumns\");\n\t\t}\n\n\t\t// bind change event listeners to inputs - TODO: move to a private method?\n\t\t$menu.find('input[type=\"checkbox\"]').on(\"change\", function(e) {\n\t\t\tonToggleCheckboxChange(e.target);\n\n\t\t\tif (self.set.length) {\n\t\t\t\tvar index;\n\t\t\t\t$(self.$popup)\n\t\t\t\t\t.find(\"input[type='checkbox']\")\n\t\t\t\t\t.each(function(j) {\n\t\t\t\t\t\tif (this === e.target) {\n\t\t\t\t\t\t\tindex = j;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t$(self.set).each(function() {\n\t\t\t\t\tvar checkbox = $(this)\n\t\t\t\t\t\t.data(data.key)\n\t\t\t\t\t\t.$popup.find(\"input[type='checkbox']\")\n\t\t\t\t\t\t.get(index);\n\t\t\t\t\tif (checkbox) {\n\t\t\t\t\t\tcheckbox.checked = e.target.checked;\n\t\t\t\t\t\tonToggleCheckboxChange(checkbox);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$menuButton.appendTo($btnContain);\n\n\t\t// Use a different target than the toolbar\n\t\tvar $btnTarget = $(this.$table.attr(this.attributes.btnTarget));\n\t\t$btnContain.appendTo($btnTarget.length ? $btnTarget : this.tablesaw.$toolbar);\n\n\t\tfunction closePopup(event) {\n\t\t\t// Click came from inside the popup, ignore.\n\t\t\tif (event && $(event.target).closest(\".\" + self.classes.popup).length) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$(document).off(\"click.\" + tableId);\n\t\t\t$menuButton.removeClass(\"up\").addClass(\"down\");\n\t\t\t$btnContain.removeClass(\"visible\");\n\t\t}\n\n\t\tvar closeTimeout;\n\t\tfunction openPopup() {\n\t\t\t$btnContain.addClass(\"visible\");\n\t\t\t$menuButton.removeClass(\"down\").addClass(\"up\");\n\n\t\t\t$(document).off(\"click.\" + tableId, closePopup);\n\n\t\t\twindow.clearTimeout(closeTimeout);\n\t\t\tcloseTimeout = window.setTimeout(function() {\n\t\t\t\t$(document).on(\"click.\" + tableId, closePopup);\n\t\t\t}, 15);\n\t\t}\n\n\t\t$menuButton.on(\"click.tablesaw\", function(event) {\n\t\t\tevent.preventDefault();\n\n\t\t\tif (!$btnContain.is(\".visible\")) {\n\t\t\t\topenPopup();\n\t\t\t} else {\n\t\t\t\tclosePopup();\n\t\t\t}\n\t\t});\n\n\t\t$popup.appendTo($btnContain);\n\n\t\tthis.$menu = $menu;\n\n\t\t// Fix for iOS not rendering shadows correctly when using `-webkit-overflow-scrolling`\n\t\tvar $overflow = this.$table.closest(\".tablesaw-overflow\");\n\t\tif ($overflow.css(\"-webkit-overflow-scrolling\")) {\n\t\t\tvar timeout;\n\t\t\t$overflow.on(\"scroll\", function() {\n\t\t\t\tvar $div = $(this);\n\t\t\t\twindow.clearTimeout(timeout);\n\t\t\t\ttimeout = window.setTimeout(function() {\n\t\t\t\t\t$div.css(\"-webkit-overflow-scrolling\", \"auto\");\n\t\t\t\t\twindow.setTimeout(function() {\n\t\t\t\t\t\t$div.css(\"-webkit-overflow-scrolling\", \"touch\");\n\t\t\t\t\t}, 0);\n\t\t\t\t}, 100);\n\t\t\t});\n\t\t}\n\n\t\t$(window).on(Tablesaw.events.resize + \".\" + tableId, function() {\n\t\t\tself.refreshToggle();\n\t\t});\n\n\t\tthis.initSet();\n\t\tthis.refreshToggle();\n\t};\n\n\tColumnToggle.prototype.getHeaderFromCheckbox = function(checkbox) {\n\t\treturn $(checkbox).data(\"tablesaw-header\");\n\t};\n\n\tColumnToggle.prototype.refreshToggle = function() {\n\t\tvar self = this;\n\t\tvar invisibleColumns = 0;\n\t\tthis.$menu.find(\"input\").each(function() {\n\t\t\tvar header = self.getHeaderFromCheckbox(this);\n\t\t\tthis.checked =\n\t\t\t\tself.tablesaw\n\t\t\t\t\t._$getCells(header)\n\t\t\t\t\t.eq(0)\n\t\t\t\t\t.css(\"display\") === \"table-cell\";\n\t\t});\n\n\t\tthis.updateColspanCells();\n\t};\n\n\tColumnToggle.prototype.updateColspanCells = function(header, userAction) {\n\t\tthis.tablesaw.updateColspanCells(\"tablesaw-toggle-cellhidden\", header, userAction);\n\t};\n\n\tColumnToggle.prototype.destroy = function() {\n\t\tthis.$table.removeClass(this.classes.columnToggleTable);\n\t\tthis.$table.find(\"th, td\").each(function() {\n\t\t\tvar $cell = $(this);\n\t\t\t$cell.removeClass(\"tablesaw-toggle-cellhidden\").removeClass(\"tablesaw-toggle-cellvisible\");\n\n\t\t\tthis.className = this.className.replace(/\\bui\\-table\\-priority\\-\\d\\b/g, \"\");\n\t\t});\n\t};\n\n\t// on tablecreate, init\n\t$(document).on(Tablesaw.events.create, function(e, tablesaw) {\n\t\tif (tablesaw.mode === \"columntoggle\") {\n\t\t\tvar table = new ColumnToggle(tablesaw.table);\n\t\t\ttable.init();\n\t\t}\n\t});\n\n\t$(document).on(Tablesaw.events.destroy, function(e, tablesaw) {\n\t\tif (tablesaw.mode === \"columntoggle\") {\n\t\t\t$(tablesaw.table)\n\t\t\t\t.data(data.key)\n\t\t\t\t.destroy();\n\t\t}\n\t});\n\n\t$(document).on(Tablesaw.events.refresh, function(e, tablesaw) {\n\t\tif (tablesaw.mode === \"columntoggle\") {\n\t\t\t$(tablesaw.table)\n\t\t\t\t.data(data.key)\n\t\t\t\t.refreshPriority();\n\t\t}\n\t});\n\n\tTablesaw.ColumnToggle = ColumnToggle;\n})();\n\n(function() {\n\tfunction getSortValue(cell) {\n\t\tvar text = [];\n\t\t$(cell.childNodes).each(function() {\n\t\t\tvar $el = $(this);\n\t\t\tif ($el.is(\"input, select\")) {\n\t\t\t\ttext.push($el.val());\n\t\t\t} else if ($el.is(\".tablesaw-cell-label\")) {\n\t\t\t} else {\n\t\t\t\ttext.push(($el.text() || \"\").replace(/^\\s+|\\s+$/g, \"\"));\n\t\t\t}\n\t\t});\n\n\t\treturn text.join(\"\");\n\t}\n\n\tvar pluginName = \"tablesaw-sortable\",\n\t\tinitSelector = \"table[data-\" + pluginName + \"]\",\n\t\tsortableSwitchSelector = \"[data-\" + pluginName + \"-switch]\",\n\t\tattrs = {\n\t\t\tsortCol: \"data-tablesaw-sortable-col\",\n\t\t\tdefaultCol: \"data-tablesaw-sortable-default-col\",\n\t\t\tnumericCol: \"data-tablesaw-sortable-numeric\",\n\t\t\tsubRow: \"data-tablesaw-subrow\",\n\t\t\tignoreRow: \"data-tablesaw-ignorerow\"\n\t\t},\n\t\tclasses = {\n\t\t\thead: pluginName + \"-head\",\n\t\t\tascend: pluginName + \"-ascending\",\n\t\t\tdescend: pluginName + \"-descending\",\n\t\t\tswitcher: pluginName + \"-switch\",\n\t\t\ttableToolbar: \"tablesaw-bar-section\",\n\t\t\tsortButton: pluginName + \"-btn\"\n\t\t},\n\t\tmethods = {\n\t\t\t_create: function(o) {\n\t\t\t\treturn $(this).each(function() {\n\t\t\t\t\tvar init = $(this).data(pluginName + \"-init\");\n\t\t\t\t\tif (init) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\t$(this)\n\t\t\t\t\t\t.data(pluginName + \"-init\", true)\n\t\t\t\t\t\t.trigger(\"beforecreate.\" + pluginName)\n\t\t\t\t\t\t[pluginName](\"_init\", o)\n\t\t\t\t\t\t.trigger(\"create.\" + pluginName);\n\t\t\t\t});\n\t\t\t},\n\t\t\t_init: function() {\n\t\t\t\tvar el = $(this);\n\t\t\t\tvar tblsaw = el.data(\"tablesaw\");\n\t\t\t\tvar heads;\n\t\t\t\tvar $switcher;\n\n\t\t\t\tfunction addClassToHeads(h) {\n\t\t\t\t\t$.each(h, function(i, v) {\n\t\t\t\t\t\t$(v).addClass(classes.head);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction makeHeadsActionable(h, fn) {\n\t\t\t\t\t$.each(h, function(i, col) {\n\t\t\t\t\t\tvar b = $(\"<button class='\" + classes.sortButton + \"'/>\");\n\t\t\t\t\t\tb.on(\"click\", { col: col }, fn);\n\t\t\t\t\t\t$(col)\n\t\t\t\t\t\t\t.wrapInner(b)\n\t\t\t\t\t\t\t.find(\"button\")\n\t\t\t\t\t\t\t.append(\"<span class='tablesaw-sortable-arrow'>\");\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction clearOthers(headcells) {\n\t\t\t\t\t$.each(headcells, function(i, v) {\n\t\t\t\t\t\tvar col = $(v);\n\t\t\t\t\t\tcol.removeAttr(attrs.defaultCol);\n\t\t\t\t\t\tcol.removeClass(classes.ascend);\n\t\t\t\t\t\tcol.removeClass(classes.descend);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction headsOnAction(e) {\n\t\t\t\t\tif ($(e.target).is(\"a[href]\")) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tvar headCell = $(e.target).closest(\"[\" + attrs.sortCol + \"]\"),\n\t\t\t\t\t\tv = e.data.col,\n\t\t\t\t\t\tnewSortValue = heads.index(headCell[0]);\n\n\t\t\t\t\tclearOthers(\n\t\t\t\t\t\theadCell\n\t\t\t\t\t\t\t.closest(\"thead\")\n\t\t\t\t\t\t\t.find(\"th\")\n\t\t\t\t\t\t\t.filter(function() {\n\t\t\t\t\t\t\t\treturn this !== headCell[0];\n\t\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t\tif (headCell.is(\".\" + classes.descend) || !headCell.is(\".\" + classes.ascend)) {\n\t\t\t\t\t\tel[pluginName](\"sortBy\", v, true);\n\t\t\t\t\t\tnewSortValue += \"_asc\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tel[pluginName](\"sortBy\", v);\n\t\t\t\t\t\tnewSortValue += \"_desc\";\n\t\t\t\t\t}\n\t\t\t\t\tif ($switcher) {\n\t\t\t\t\t\t$switcher\n\t\t\t\t\t\t\t.find(\"select\")\n\t\t\t\t\t\t\t.val(newSortValue)\n\t\t\t\t\t\t\t.trigger(\"refresh\");\n\t\t\t\t\t}\n\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\n\t\t\t\tfunction handleDefault(heads) {\n\t\t\t\t\t$.each(heads, function(idx, el) {\n\t\t\t\t\t\tvar $el = $(el);\n\t\t\t\t\t\tif ($el.is(\"[\" + attrs.defaultCol + \"]\")) {\n\t\t\t\t\t\t\tif (!$el.is(\".\" + classes.descend)) {\n\t\t\t\t\t\t\t\t$el.addClass(classes.ascend);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction addSwitcher(heads) {\n\t\t\t\t\t$switcher = $(\"<div>\")\n\t\t\t\t\t\t.addClass(classes.switcher)\n\t\t\t\t\t\t.addClass(classes.tableToolbar);\n\n\t\t\t\t\tvar html = [\"<label>\" + Tablesaw.i18n.sort + \":\"];\n\n\t\t\t\t\t// TODO next major version: remove .btn\n\t\t\t\t\thtml.push('<span class=\"btn tablesaw-btn\"><select>');\n\t\t\t\t\theads.each(function(j) {\n\t\t\t\t\t\tvar $t = $(this);\n\t\t\t\t\t\tvar isDefaultCol = $t.is(\"[\" + attrs.defaultCol + \"]\");\n\t\t\t\t\t\tvar isDescending = $t.is(\".\" + classes.descend);\n\n\t\t\t\t\t\tvar hasNumericAttribute = $t.is(\"[\" + attrs.numericCol + \"]\");\n\t\t\t\t\t\tvar numericCount = 0;\n\t\t\t\t\t\t// Check only the first four rows to see if the column is numbers.\n\t\t\t\t\t\tvar numericCountMax = 5;\n\n\t\t\t\t\t\t$(this.cells.slice(0, numericCountMax)).each(function() {\n\t\t\t\t\t\t\tif (!isNaN(parseInt(getSortValue(this), 10))) {\n\t\t\t\t\t\t\t\tnumericCount++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tvar isNumeric = numericCount === numericCountMax;\n\t\t\t\t\t\tif (!hasNumericAttribute) {\n\t\t\t\t\t\t\t$t.attr(attrs.numericCol, isNumeric ? \"\" : \"false\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\thtml.push(\n\t\t\t\t\t\t\t\"<option\" +\n\t\t\t\t\t\t\t\t(isDefaultCol && !isDescending ? \" selected\" : \"\") +\n\t\t\t\t\t\t\t\t' value=\"' +\n\t\t\t\t\t\t\t\tj +\n\t\t\t\t\t\t\t\t'_asc\">' +\n\t\t\t\t\t\t\t\t$t.text() +\n\t\t\t\t\t\t\t\t\" \" +\n\t\t\t\t\t\t\t\t(isNumeric ? \"&#x2191;\" : \"(A-Z)\") +\n\t\t\t\t\t\t\t\t\"</option>\"\n\t\t\t\t\t\t);\n\t\t\t\t\t\thtml.push(\n\t\t\t\t\t\t\t\"<option\" +\n\t\t\t\t\t\t\t\t(isDefaultCol && isDescending ? \" selected\" : \"\") +\n\t\t\t\t\t\t\t\t' value=\"' +\n\t\t\t\t\t\t\t\tj +\n\t\t\t\t\t\t\t\t'_desc\">' +\n\t\t\t\t\t\t\t\t$t.text() +\n\t\t\t\t\t\t\t\t\" \" +\n\t\t\t\t\t\t\t\t(isNumeric ? \"&#x2193;\" : \"(Z-A)\") +\n\t\t\t\t\t\t\t\t\"</option>\"\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t\thtml.push(\"</select></span></label>\");\n\n\t\t\t\t\t$switcher.html(html.join(\"\"));\n\n\t\t\t\t\tvar $firstChild = tblsaw.$toolbar.children().eq(0);\n\t\t\t\t\tif ($firstChild.length) {\n\t\t\t\t\t\t$switcher.insertBefore($firstChild);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$switcher.appendTo(tblsaw.$toolbar);\n\t\t\t\t\t}\n\t\t\t\t\t$switcher.find(\".tablesaw-btn\").tablesawbtn();\n\t\t\t\t\t$switcher.find(\"select\").on(\"change\", function() {\n\t\t\t\t\t\tvar val = $(this)\n\t\t\t\t\t\t\t\t.val()\n\t\t\t\t\t\t\t\t.split(\"_\"),\n\t\t\t\t\t\t\thead = heads.eq(val[0]);\n\n\t\t\t\t\t\tclearOthers(head.siblings());\n\t\t\t\t\t\tel[pluginName](\"sortBy\", head.get(0), val[1] === \"asc\");\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tel.addClass(pluginName);\n\n\t\t\t\theads = el\n\t\t\t\t\t.children()\n\t\t\t\t\t.filter(\"thead\")\n\t\t\t\t\t.find(\"th[\" + attrs.sortCol + \"]\");\n\n\t\t\t\taddClassToHeads(heads);\n\t\t\t\tmakeHeadsActionable(heads, headsOnAction);\n\t\t\t\thandleDefault(heads);\n\n\t\t\t\tif (el.is(sortableSwitchSelector)) {\n\t\t\t\t\taddSwitcher(heads);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsortRows: function(rows, colNum, ascending, col, tbody) {\n\t\t\t\tfunction convertCells(cellArr, belongingToTbody) {\n\t\t\t\t\tvar cells = [];\n\t\t\t\t\t$.each(cellArr, function(i, cell) {\n\t\t\t\t\t\tvar row = cell.parentNode;\n\t\t\t\t\t\tvar $row = $(row);\n\t\t\t\t\t\t// next row is a subrow\n\t\t\t\t\t\tvar subrows = [];\n\t\t\t\t\t\tvar $next = $row.next();\n\t\t\t\t\t\twhile ($next.is(\"[\" + attrs.subRow + \"]\")) {\n\t\t\t\t\t\t\tsubrows.push($next[0]);\n\t\t\t\t\t\t\t$next = $next.next();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar tbody = row.parentNode;\n\n\t\t\t\t\t\t// current row is a subrow\n\t\t\t\t\t\tif ($row.is(\"[\" + attrs.subRow + \"]\")) {\n\t\t\t\t\t\t} else if (tbody === belongingToTbody) {\n\t\t\t\t\t\t\tcells.push({\n\t\t\t\t\t\t\t\telement: cell,\n\t\t\t\t\t\t\t\tcell: getSortValue(cell),\n\t\t\t\t\t\t\t\trow: row,\n\t\t\t\t\t\t\t\tsubrows: subrows.length ? subrows : null,\n\t\t\t\t\t\t\t\tignored: $row.is(\"[\" + attrs.ignoreRow + \"]\")\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn cells;\n\t\t\t\t}\n\n\t\t\t\tfunction getSortFxn(ascending, forceNumeric) {\n\t\t\t\t\tvar fn,\n\t\t\t\t\t\tregex = /[^\\-\\+\\d\\.]/g;\n\t\t\t\t\tif (ascending) {\n\t\t\t\t\t\tfn = function(a, b) {\n\t\t\t\t\t\t\tif (a.ignored || b.ignored) {\n\t\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (forceNumeric) {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\tparseFloat(a.cell.replace(regex, \"\")) - parseFloat(b.cell.replace(regex, \"\"))\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn a.cell.toLowerCase() > b.cell.toLowerCase() ? 1 : -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfn = function(a, b) {\n\t\t\t\t\t\t\tif (a.ignored || b.ignored) {\n\t\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (forceNumeric) {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\tparseFloat(b.cell.replace(regex, \"\")) - parseFloat(a.cell.replace(regex, \"\"))\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn a.cell.toLowerCase() < b.cell.toLowerCase() ? 1 : -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\treturn fn;\n\t\t\t\t}\n\n\t\t\t\tfunction convertToRows(sorted) {\n\t\t\t\t\tvar newRows = [],\n\t\t\t\t\t\ti,\n\t\t\t\t\t\tl;\n\t\t\t\t\tfor (i = 0, l = sorted.length; i < l; i++) {\n\t\t\t\t\t\tnewRows.push(sorted[i].row);\n\t\t\t\t\t\tif (sorted[i].subrows) {\n\t\t\t\t\t\t\tnewRows.push(sorted[i].subrows);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn newRows;\n\t\t\t\t}\n\n\t\t\t\tvar fn;\n\t\t\t\tvar sorted;\n\t\t\t\tvar cells = convertCells(col.cells, tbody);\n\n\t\t\t\tvar customFn = $(col).data(\"tablesaw-sort\");\n\n\t\t\t\tfn =\n\t\t\t\t\t(customFn && typeof customFn === \"function\" ? customFn(ascending) : false) ||\n\t\t\t\t\tgetSortFxn(\n\t\t\t\t\t\tascending,\n\t\t\t\t\t\t$(col).is(\"[\" + attrs.numericCol + \"]\") &&\n\t\t\t\t\t\t\t!$(col).is(\"[\" + attrs.numericCol + '=\"false\"]')\n\t\t\t\t\t);\n\n\t\t\t\tsorted = cells.sort(fn);\n\n\t\t\t\trows = convertToRows(sorted);\n\n\t\t\t\treturn rows;\n\t\t\t},\n\t\t\tmakeColDefault: function(col, a) {\n\t\t\t\tvar c = $(col);\n\t\t\t\tc.attr(attrs.defaultCol, \"true\");\n\t\t\t\tif (a) {\n\t\t\t\t\tc.removeClass(classes.descend);\n\t\t\t\t\tc.addClass(classes.ascend);\n\t\t\t\t} else {\n\t\t\t\t\tc.removeClass(classes.ascend);\n\t\t\t\t\tc.addClass(classes.descend);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsortBy: function(col, ascending) {\n\t\t\t\tvar el = $(this);\n\t\t\t\tvar colNum;\n\t\t\t\tvar tbl = el.data(\"tablesaw\");\n\t\t\t\ttbl.$tbody.each(function() {\n\t\t\t\t\tvar tbody = this;\n\t\t\t\t\tvar $tbody = $(this);\n\t\t\t\t\tvar rows = tbl.getBodyRows(tbody);\n\t\t\t\t\tvar sortedRows;\n\t\t\t\t\tvar map = tbl.headerMapping[0];\n\t\t\t\t\tvar j, k;\n\n\t\t\t\t\t// find the column number that were sorting\n\t\t\t\t\tfor (j = 0, k = map.length; j < k; j++) {\n\t\t\t\t\t\tif (map[j] === col) {\n\t\t\t\t\t\t\tcolNum = j;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tsortedRows = el[pluginName](\"sortRows\", rows, colNum, ascending, col, tbody);\n\n\t\t\t\t\t// replace Table rows\n\t\t\t\t\tfor (j = 0, k = sortedRows.length; j < k; j++) {\n\t\t\t\t\t\t$tbody.append(sortedRows[j]);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tel[pluginName](\"makeColDefault\", col, ascending);\n\n\t\t\t\tel.trigger(\"tablesaw-sorted\");\n\t\t\t}\n\t\t};\n\n\t// Collection method.\n\t$.fn[pluginName] = function(arrg) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1),\n\t\t\treturnVal;\n\n\t\t// if it's a method\n\t\tif (arrg && typeof arrg === \"string\") {\n\t\t\treturnVal = $.fn[pluginName].prototype[arrg].apply(this[0], args);\n\t\t\treturn typeof returnVal !== \"undefined\" ? returnVal : $(this);\n\t\t}\n\t\t// check init\n\t\tif (!$(this).data(pluginName + \"-active\")) {\n\t\t\t$(this).data(pluginName + \"-active\", true);\n\t\t\t$.fn[pluginName].prototype._create.call(this, arrg);\n\t\t}\n\t\treturn $(this);\n\t};\n\t// add methods\n\t$.extend($.fn[pluginName].prototype, methods);\n\n\t$(document).on(Tablesaw.events.create, function(e, Tablesaw) {\n\t\tif (Tablesaw.$table.is(initSelector)) {\n\t\t\tTablesaw.$table[pluginName]();\n\t\t}\n\t});\n\n\t// TODO OOP this and add to Tablesaw object\n})();\n\n(function() {\n\tvar classes = {\n\t\thideBtn: \"disabled\",\n\t\tpersistWidths: \"tablesaw-fix-persist\",\n\t\thiddenCol: \"tablesaw-swipe-cellhidden\",\n\t\tpersistCol: \"tablesaw-swipe-cellpersist\",\n\t\tallColumnsVisible: \"tablesaw-all-cols-visible\"\n\t};\n\tvar attrs = {\n\t\tdisableTouchEvents: \"data-tablesaw-no-touch\",\n\t\tignorerow: \"data-tablesaw-ignorerow\",\n\t\tsubrow: \"data-tablesaw-subrow\"\n\t};\n\n\tfunction createSwipeTable(tbl, $table) {\n\t\tvar tblsaw = $table.data(\"tablesaw\");\n\n\t\tvar $btns = $(\"<div class='tablesaw-advance'></div>\");\n\t\t// TODO next major version: remove .btn\n\t\tvar $prevBtn = $(\n\t\t\t\"<a href='#' class='btn tablesaw-nav-btn tablesaw-btn btn-micro left'>\" +\n\t\t\t\tTablesaw.i18n.swipePreviousColumn +\n\t\t\t\t\"</a>\"\n\t\t).appendTo($btns);\n\t\t// TODO next major version: remove .btn\n\t\tvar $nextBtn = $(\n\t\t\t\"<a href='#' class='btn tablesaw-nav-btn tablesaw-btn btn-micro right'>\" +\n\t\t\t\tTablesaw.i18n.swipeNextColumn +\n\t\t\t\t\"</a>\"\n\t\t).appendTo($btns);\n\n\t\tvar $headerCells = tbl._getPrimaryHeaderCells();\n\t\tvar $headerCellsNoPersist = $headerCells.not('[data-tablesaw-priority=\"persist\"]');\n\t\tvar headerWidths = [];\n\t\tvar $head = $(document.head || \"head\");\n\t\tvar tableId = $table.attr(\"id\");\n\n\t\tif (!$headerCells.length) {\n\t\t\tthrow new Error(\"tablesaw swipe: no header cells found.\");\n\t\t}\n\n\t\t$table.addClass(\"tablesaw-swipe\");\n\n\t\tfunction initMinHeaderWidths() {\n\t\t\t$table.css({\n\t\t\t\twidth: \"1px\"\n\t\t\t});\n\n\t\t\t// remove any hidden columns\n\t\t\t$table.find(\".\" + classes.hiddenCol).removeClass(classes.hiddenCol);\n\n\t\t\theaderWidths = [];\n\t\t\t// Calculate initial widths\n\t\t\t$headerCells.each(function() {\n\t\t\t\theaderWidths.push(this.offsetWidth);\n\t\t\t});\n\n\t\t\t// reset props\n\t\t\t$table.css({\n\t\t\t\twidth: \"\"\n\t\t\t});\n\t\t}\n\n\t\tinitMinHeaderWidths();\n\n\t\t$btns.appendTo(tblsaw.$toolbar);\n\n\t\tif (!tableId) {\n\t\t\ttableId = \"tableswipe-\" + Math.round(Math.random() * 10000);\n\t\t\t$table.attr(\"id\", tableId);\n\t\t}\n\n\t\tfunction showColumn(headerCell) {\n\t\t\ttblsaw._$getCells(headerCell).removeClass(classes.hiddenCol);\n\t\t}\n\n\t\tfunction hideColumn(headerCell) {\n\t\t\ttblsaw._$getCells(headerCell).addClass(classes.hiddenCol);\n\t\t}\n\n\t\tfunction persistColumn(headerCell) {\n\t\t\ttblsaw._$getCells(headerCell).addClass(classes.persistCol);\n\t\t}\n\n\t\tfunction isPersistent(headerCell) {\n\t\t\treturn $(headerCell).is('[data-tablesaw-priority=\"persist\"]');\n\t\t}\n\n\t\tfunction unmaintainWidths() {\n\t\t\t$table.removeClass(classes.persistWidths);\n\t\t\t$(\"#\" + tableId + \"-persist\").remove();\n\t\t}\n\n\t\tfunction maintainWidths() {\n\t\t\tvar prefix = \"#\" + tableId + \".tablesaw-swipe \",\n\t\t\t\tstyles = [],\n\t\t\t\ttableWidth = $table.width(),\n\t\t\t\thash = [],\n\t\t\t\tnewHash;\n\n\t\t\t// save persistent column widths (as long as they take up less than 75% of table width)\n\t\t\t$headerCells.each(function(index) {\n\t\t\t\tvar width;\n\t\t\t\tif (isPersistent(this)) {\n\t\t\t\t\twidth = this.offsetWidth;\n\n\t\t\t\t\tif (width < tableWidth * 0.75) {\n\t\t\t\t\t\thash.push(index + \"-\" + width);\n\t\t\t\t\t\tstyles.push(\n\t\t\t\t\t\t\tprefix +\n\t\t\t\t\t\t\t\t\" .\" +\n\t\t\t\t\t\t\t\tclasses.persistCol +\n\t\t\t\t\t\t\t\t\":nth-child(\" +\n\t\t\t\t\t\t\t\t(index + 1) +\n\t\t\t\t\t\t\t\t\") { width: \" +\n\t\t\t\t\t\t\t\twidth +\n\t\t\t\t\t\t\t\t\"px; }\"\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tnewHash = hash.join(\"_\");\n\n\t\t\tif (styles.length) {\n\t\t\t\t$table.addClass(classes.persistWidths);\n\t\t\t\tvar $style = $(\"#\" + tableId + \"-persist\");\n\t\t\t\t// If style element not yet added OR if the widths have changed\n\t\t\t\tif (!$style.length || $style.data(\"tablesaw-hash\") !== newHash) {\n\t\t\t\t\t// Remove existing\n\t\t\t\t\t$style.remove();\n\n\t\t\t\t\t$(\"<style>\" + styles.join(\"\\n\") + \"</style>\")\n\t\t\t\t\t\t.attr(\"id\", tableId + \"-persist\")\n\t\t\t\t\t\t.data(\"tablesaw-hash\", newHash)\n\t\t\t\t\t\t.appendTo($head);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction getNext() {\n\t\t\tvar next = [],\n\t\t\t\tcheckFound;\n\n\t\t\t$headerCellsNoPersist.each(function(i) {\n\t\t\t\tvar $t = $(this),\n\t\t\t\t\tisHidden = $t.css(\"display\") === \"none\" || $t.is(\".\" + classes.hiddenCol);\n\n\t\t\t\tif (!isHidden && !checkFound) {\n\t\t\t\t\tcheckFound = true;\n\t\t\t\t\tnext[0] = i;\n\t\t\t\t} else if (isHidden && checkFound) {\n\t\t\t\t\tnext[1] = i;\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn next;\n\t\t}\n\n\t\tfunction getPrev() {\n\t\t\tvar next = getNext();\n\t\t\treturn [next[1] - 1, next[0] - 1];\n\t\t}\n\n\t\tfunction nextpair(fwd) {\n\t\t\treturn fwd ? getNext() : getPrev();\n\t\t}\n\n\t\tfunction canAdvance(pair) {\n\t\t\treturn pair[1] > -1 && pair[1] < $headerCellsNoPersist.length;\n\t\t}\n\n\t\tfunction matchesMedia() {\n\t\t\tvar matchMedia = $table.attr(\"data-tablesaw-swipe-media\");\n\t\t\treturn !matchMedia || (\"matchMedia\" in window && window.matchMedia(matchMedia).matches);\n\t\t}\n\n\t\tfunction fakeBreakpoints() {\n\t\t\tif (!matchesMedia()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar containerWidth = $table.parent().width(),\n\t\t\t\tpersist = [],\n\t\t\t\tsum = 0,\n\t\t\t\tsums = [],\n\t\t\t\tvisibleNonPersistantCount = $headerCells.length;\n\n\t\t\t$headerCells.each(function(index) {\n\t\t\t\tvar $t = $(this),\n\t\t\t\t\tisPersist = $t.is('[data-tablesaw-priority=\"persist\"]');\n\n\t\t\t\tpersist.push(isPersist);\n\t\t\t\tsum += headerWidths[index];\n\t\t\t\tsums.push(sum);\n\n\t\t\t\t// is persistent or is hidden\n\t\t\t\tif (isPersist || sum > containerWidth) {\n\t\t\t\t\tvisibleNonPersistantCount--;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// We need at least one column to swipe.\n\t\t\tvar needsNonPersistentColumn = visibleNonPersistantCount === 0;\n\n\t\t\t$headerCells.each(function(index) {\n\t\t\t\tif (sums[index] > containerWidth) {\n\t\t\t\t\thideColumn(this);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$headerCells.each(function(index) {\n\t\t\t\tif (persist[index]) {\n\t\t\t\t\t// for visual box-shadow\n\t\t\t\t\tpersistColumn(this);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (sums[index] <= containerWidth || needsNonPersistentColumn) {\n\t\t\t\t\tneedsNonPersistentColumn = false;\n\t\t\t\t\tshowColumn(this);\n\t\t\t\t\ttblsaw.updateColspanCells(classes.hiddenCol, this, true);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tunmaintainWidths();\n\n\t\t\t$table.trigger(\"tablesawcolumns\");\n\t\t}\n\n\t\tfunction advance(fwd) {\n\t\t\tvar pair = nextpair(fwd);\n\t\t\tif (canAdvance(pair)) {\n\t\t\t\tif (isNaN(pair[0])) {\n\t\t\t\t\tif (fwd) {\n\t\t\t\t\t\tpair[0] = 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpair[0] = $headerCellsNoPersist.length - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// TODO just blindly hiding the previous column and showing the next column can result in\n\t\t\t\t// column content overflow\n\t\t\t\tmaintainWidths();\n\t\t\t\thideColumn($headerCellsNoPersist.get(pair[0]));\n\t\t\t\ttblsaw.updateColspanCells(classes.hiddenCol, $headerCellsNoPersist.get(pair[0]), false);\n\n\t\t\t\tshowColumn($headerCellsNoPersist.get(pair[1]));\n\t\t\t\ttblsaw.updateColspanCells(classes.hiddenCol, $headerCellsNoPersist.get(pair[1]), true);\n\n\t\t\t\t$table.trigger(\"tablesawcolumns\");\n\t\t\t}\n\t\t}\n\n\t\t$prevBtn.add($nextBtn).on(\"click\", function(e) {\n\t\t\tadvance(!!$(e.target).closest($nextBtn).length);\n\t\t\te.preventDefault();\n\t\t});\n\n\t\tfunction getCoord(event, key) {\n\t\t\treturn (event.touches || event.originalEvent.touches)[0][key];\n\t\t}\n\n\t\tif (!$table.is(\"[\" + attrs.disableTouchEvents + \"]\")) {\n\t\t\t$table.on(\"touchstart.swipetoggle\", function(e) {\n\t\t\t\tvar originX = getCoord(e, \"pageX\");\n\t\t\t\tvar originY = getCoord(e, \"pageY\");\n\t\t\t\tvar x;\n\t\t\t\tvar y;\n\t\t\t\tvar scrollTop = window.pageYOffset;\n\n\t\t\t\t$(window).off(Tablesaw.events.resize, fakeBreakpoints);\n\n\t\t\t\t$(this)\n\t\t\t\t\t.on(\"touchmove.swipetoggle\", function(e) {\n\t\t\t\t\t\tx = getCoord(e, \"pageX\");\n\t\t\t\t\t\ty = getCoord(e, \"pageY\");\n\t\t\t\t\t})\n\t\t\t\t\t.on(\"touchend.swipetoggle\", function() {\n\t\t\t\t\t\tvar cfg = tbl.getConfig({\n\t\t\t\t\t\t\tswipeHorizontalThreshold: 30,\n\t\t\t\t\t\t\tswipeVerticalThreshold: 30\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// This config code is a little awkward because shoestring doesnt support deep $.extend\n\t\t\t\t\t\t// Trying to work around when devs only override one of (not both) horizontalThreshold or\n\t\t\t\t\t\t// verticalThreshold in their TablesawConfig.\n\t\t\t\t\t\t// @TODO major version bump: remove cfg.swipe, move to just use the swipePrefix keys\n\t\t\t\t\t\tvar verticalThreshold = cfg.swipe\n\t\t\t\t\t\t\t? cfg.swipe.verticalThreshold\n\t\t\t\t\t\t\t: cfg.swipeVerticalThreshold;\n\t\t\t\t\t\tvar horizontalThreshold = cfg.swipe\n\t\t\t\t\t\t\t? cfg.swipe.horizontalThreshold\n\t\t\t\t\t\t\t: cfg.swipeHorizontalThreshold;\n\n\t\t\t\t\t\tvar isPageScrolled = Math.abs(window.pageYOffset - scrollTop) >= verticalThreshold;\n\t\t\t\t\t\tvar isVerticalSwipe = Math.abs(y - originY) >= verticalThreshold;\n\n\t\t\t\t\t\tif (!isVerticalSwipe && !isPageScrolled) {\n\t\t\t\t\t\t\tif (x - originX < -1 * horizontalThreshold) {\n\t\t\t\t\t\t\t\tadvance(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (x - originX > horizontalThreshold) {\n\t\t\t\t\t\t\t\tadvance(false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\twindow.setTimeout(function() {\n\t\t\t\t\t\t\t$(window).on(Tablesaw.events.resize, fakeBreakpoints);\n\t\t\t\t\t\t}, 300);\n\n\t\t\t\t\t\t$(this).off(\"touchmove.swipetoggle touchend.swipetoggle\");\n\t\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t$table\n\t\t\t.on(\"tablesawcolumns.swipetoggle\", function() {\n\t\t\t\tvar canGoPrev = canAdvance(getPrev());\n\t\t\t\tvar canGoNext = canAdvance(getNext());\n\t\t\t\t$prevBtn[canGoPrev ? \"removeClass\" : \"addClass\"](classes.hideBtn);\n\t\t\t\t$nextBtn[canGoNext ? \"removeClass\" : \"addClass\"](classes.hideBtn);\n\n\t\t\t\ttblsaw.$toolbar[!canGoPrev && !canGoNext ? \"addClass\" : \"removeClass\"](\n\t\t\t\t\tclasses.allColumnsVisible\n\t\t\t\t);\n\t\t\t})\n\t\t\t.on(\"tablesawnext.swipetoggle\", function() {\n\t\t\t\tadvance(true);\n\t\t\t})\n\t\t\t.on(\"tablesawprev.swipetoggle\", function() {\n\t\t\t\tadvance(false);\n\t\t\t})\n\t\t\t.on(Tablesaw.events.destroy + \".swipetoggle\", function() {\n\t\t\t\tvar $t = $(this);\n\n\t\t\t\t$t.removeClass(\"tablesaw-swipe\");\n\t\t\t\ttblsaw.$toolbar.find(\".tablesaw-advance\").remove();\n\t\t\t\t$(window).off(Tablesaw.events.resize, fakeBreakpoints);\n\n\t\t\t\t$t.off(\".swipetoggle\");\n\t\t\t})\n\t\t\t.on(Tablesaw.events.refresh, function() {\n\t\t\t\tunmaintainWidths();\n\t\t\t\tinitMinHeaderWidths();\n\t\t\t\tfakeBreakpoints();\n\t\t\t});\n\n\t\tfakeBreakpoints();\n\t\t$(window).on(Tablesaw.events.resize, fakeBreakpoints);\n\t}\n\n\t// on tablecreate, init\n\t$(document).on(Tablesaw.events.create, function(e, tablesaw) {\n\t\tif (tablesaw.mode === \"swipe\") {\n\t\t\tcreateSwipeTable(tablesaw, tablesaw.$table);\n\t\t}\n\t});\n\n\t// TODO OOP this and add to Tablesaw object\n})();\n\n(function() {\n\tvar MiniMap = {\n\t\tattr: {\n\t\t\tinit: \"data-tablesaw-minimap\"\n\t\t},\n\t\tshow: function(table) {\n\t\t\tvar mq = table.getAttribute(MiniMap.attr.init);\n\n\t\t\tif (mq === \"\") {\n\t\t\t\t// value-less but exists\n\t\t\t\treturn true;\n\t\t\t} else if (mq && \"matchMedia\" in window) {\n\t\t\t\t// has a mq value\n\t\t\t\treturn window.matchMedia(mq).matches;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tfunction createMiniMap($table) {\n\t\tvar tblsaw = $table.data(\"tablesaw\");\n\t\tvar $btns = $('<div class=\"tablesaw-advance minimap\">');\n\t\tvar $dotNav = $('<ul class=\"tablesaw-advance-dots\">').appendTo($btns);\n\t\tvar hideDot = \"tablesaw-advance-dots-hide\";\n\t\tvar $headerCells = $table.data(\"tablesaw\")._getPrimaryHeaderCells();\n\n\t\t// populate dots\n\t\t$headerCells.each(function() {\n\t\t\t$dotNav.append(\"<li><i></i></li>\");\n\t\t});\n\n\t\t$btns.appendTo(tblsaw.$toolbar);\n\n\t\tfunction showHideNav() {\n\t\t\tif (!MiniMap.show($table[0])) {\n\t\t\t\t$btns.css(\"display\", \"none\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t$btns.css(\"display\", \"block\");\n\n\t\t\t// show/hide dots\n\t\t\tvar dots = $dotNav.find(\"li\").removeClass(hideDot);\n\t\t\t$table.find(\"thead th\").each(function(i) {\n\t\t\t\tif ($(this).css(\"display\") === \"none\") {\n\t\t\t\t\tdots.eq(i).addClass(hideDot);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// run on init and resize\n\t\tshowHideNav();\n\t\t$(window).on(Tablesaw.events.resize, showHideNav);\n\n\t\t$table\n\t\t\t.on(\"tablesawcolumns.minimap\", function() {\n\t\t\t\tshowHideNav();\n\t\t\t})\n\t\t\t.on(Tablesaw.events.destroy + \".minimap\", function() {\n\t\t\t\tvar $t = $(this);\n\n\t\t\t\ttblsaw.$toolbar.find(\".tablesaw-advance\").remove();\n\t\t\t\t$(window).off(Tablesaw.events.resize, showHideNav);\n\n\t\t\t\t$t.off(\".minimap\");\n\t\t\t});\n\t}\n\n\t// on tablecreate, init\n\t$(document).on(Tablesaw.events.create, function(e, tablesaw) {\n\t\tif (\n\t\t\t(tablesaw.mode === \"swipe\" || tablesaw.mode === \"columntoggle\") &&\n\t\t\ttablesaw.$table.is(\"[ \" + MiniMap.attr.init + \"]\")\n\t\t) {\n\t\t\tcreateMiniMap(tablesaw.$table);\n\t\t}\n\t});\n\n\t// TODO OOP this better\n\tTablesaw.MiniMap = MiniMap;\n})();\n\n(function() {\n\tvar S = {\n\t\tselectors: {\n\t\t\tinit: \"table[data-tablesaw-mode-switch]\"\n\t\t},\n\t\tattributes: {\n\t\t\texcludeMode: \"data-tablesaw-mode-exclude\"\n\t\t},\n\t\tclasses: {\n\t\t\tmain: \"tablesaw-modeswitch\",\n\t\t\ttoolbar: \"tablesaw-bar-section\"\n\t\t},\n\t\tmodes: [\"stack\", \"swipe\", \"columntoggle\"],\n\t\tinit: function(table) {\n\t\t\tvar $table = $(table);\n\t\t\tvar tblsaw = $table.data(\"tablesaw\");\n\t\t\tvar ignoreMode = $table.attr(S.attributes.excludeMode);\n\t\t\tvar $toolbar = tblsaw.$toolbar;\n\t\t\tvar $switcher = $(\"<div>\").addClass(S.classes.main + \" \" + S.classes.toolbar);\n\n\t\t\tvar html = [\n\t\t\t\t\t'<label><span class=\"abbreviated\">' +\n\t\t\t\t\t\tTablesaw.i18n.modeSwitchColumnsAbbreviated +\n\t\t\t\t\t\t'</span><span class=\"longform\">' +\n\t\t\t\t\t\tTablesaw.i18n.modeSwitchColumns +\n\t\t\t\t\t\t\"</span>:\"\n\t\t\t\t],\n\t\t\t\tdataMode = $table.attr(\"data-tablesaw-mode\"),\n\t\t\t\tisSelected;\n\n\t\t\t// TODO next major version: remove .btn\n\t\t\thtml.push('<span class=\"btn tablesaw-btn\"><select>');\n\t\t\tfor (var j = 0, k = S.modes.length; j < k; j++) {\n\t\t\t\tif (ignoreMode && ignoreMode.toLowerCase() === S.modes[j]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tisSelected = dataMode === S.modes[j];\n\n\t\t\t\thtml.push(\n\t\t\t\t\t\"<option\" +\n\t\t\t\t\t\t(isSelected ? \" selected\" : \"\") +\n\t\t\t\t\t\t' value=\"' +\n\t\t\t\t\t\tS.modes[j] +\n\t\t\t\t\t\t'\">' +\n\t\t\t\t\t\tTablesaw.i18n.modes[j] +\n\t\t\t\t\t\t\"</option>\"\n\t\t\t\t);\n\t\t\t}\n\t\t\thtml.push(\"</select></span></label>\");\n\n\t\t\t$switcher.html(html.join(\"\"));\n\n\t\t\tvar $otherToolbarItems = $toolbar.find(\".tablesaw-advance\").eq(0);\n\t\t\tif ($otherToolbarItems.length) {\n\t\t\t\t$switcher.insertBefore($otherToolbarItems);\n\t\t\t} else {\n\t\t\t\t$switcher.appendTo($toolbar);\n\t\t\t}\n\n\t\t\t$switcher.find(\".tablesaw-btn\").tablesawbtn();\n\t\t\t$switcher.find(\"select\").on(\"change\", function(event) {\n\t\t\t\treturn S.onModeChange.call(table, event, $(this).val());\n\t\t\t});\n\t\t},\n\t\tonModeChange: function(event, val) {\n\t\t\tvar $table = $(this);\n\t\t\tvar tblsaw = $table.data(\"tablesaw\");\n\t\t\tvar $switcher = tblsaw.$toolbar.find(\".\" + S.classes.main);\n\n\t\t\t$switcher.remove();\n\t\t\ttblsaw.destroy();\n\n\t\t\t$table.attr(\"data-tablesaw-mode\", val);\n\t\t\t$table.tablesaw();\n\t\t}\n\t};\n\n\t$(document).on(Tablesaw.events.create, function(e, Tablesaw) {\n\t\tif (Tablesaw.$table.is(S.selectors.init)) {\n\t\t\tS.init(Tablesaw.table);\n\t\t}\n\t});\n\n\t// TODO OOP this and add to Tablesaw object\n})();\n\n(function() {\n\tvar pluginName = \"tablesawCheckAll\";\n\n\tfunction CheckAll(tablesaw) {\n\t\tthis.tablesaw = tablesaw;\n\t\tthis.$table = tablesaw.$table;\n\n\t\tthis.attr = \"data-tablesaw-checkall\";\n\t\tthis.checkAllSelector = \"[\" + this.attr + \"]\";\n\t\tthis.forceCheckedSelector = \"[\" + this.attr + \"-checked]\";\n\t\tthis.forceUncheckedSelector = \"[\" + this.attr + \"-unchecked]\";\n\t\tthis.checkboxSelector = 'input[type=\"checkbox\"]';\n\n\t\tthis.$triggers = null;\n\t\tthis.$checkboxes = null;\n\n\t\tif (this.$table.data(pluginName)) {\n\t\t\treturn;\n\t\t}\n\t\tthis.$table.data(pluginName, this);\n\t\tthis.init();\n\t}\n\n\tCheckAll.prototype._filterCells = function($checkboxes) {\n\t\treturn $checkboxes\n\t\t\t.filter(function() {\n\t\t\t\treturn !$(this)\n\t\t\t\t\t.closest(\"tr\")\n\t\t\t\t\t.is(\"[data-tablesaw-subrow],[data-tablesaw-ignorerow]\");\n\t\t\t})\n\t\t\t.find(this.checkboxSelector)\n\t\t\t.not(this.checkAllSelector);\n\t};\n\n\t// With buttons you can use a scoping selector like: data-tablesaw-checkall=\"#my-scoped-id input[type='checkbox']\"\n\tCheckAll.prototype.getCheckboxesForButton = function(button) {\n\t\treturn this._filterCells($($(button).attr(this.attr)));\n\t};\n\n\tCheckAll.prototype.getCheckboxesForCheckbox = function(checkbox) {\n\t\treturn this._filterCells($($(checkbox).closest(\"th\")[0].cells));\n\t};\n\n\tCheckAll.prototype.init = function() {\n\t\tvar self = this;\n\t\tthis.$table.find(this.checkAllSelector).each(function() {\n\t\t\tvar $trigger = $(this);\n\t\t\tif ($trigger.is(self.checkboxSelector)) {\n\t\t\t\tself.addCheckboxEvents(this);\n\t\t\t} else {\n\t\t\t\tself.addButtonEvents(this);\n\t\t\t}\n\t\t});\n\t};\n\n\tCheckAll.prototype.addButtonEvents = function(trigger) {\n\t\tvar self = this;\n\n\t\t// Update body checkboxes when header checkbox is changed\n\t\t$(trigger).on(\"click\", function(event) {\n\t\t\tevent.preventDefault();\n\n\t\t\tvar $checkboxes = self.getCheckboxesForButton(this);\n\n\t\t\tvar allChecked = true;\n\t\t\t$checkboxes.each(function() {\n\t\t\t\tif (!this.checked) {\n\t\t\t\t\tallChecked = false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvar setChecked;\n\t\t\tif ($(this).is(self.forceCheckedSelector)) {\n\t\t\t\tsetChecked = true;\n\t\t\t} else if ($(this).is(self.forceUncheckedSelector)) {\n\t\t\t\tsetChecked = false;\n\t\t\t} else {\n\t\t\t\tsetChecked = allChecked ? false : true;\n\t\t\t}\n\n\t\t\t$checkboxes.each(function() {\n\t\t\t\tthis.checked = setChecked;\n\n\t\t\t\t$(this).trigger(\"change.\" + pluginName);\n\t\t\t});\n\t\t});\n\t};\n\n\tCheckAll.prototype.addCheckboxEvents = function(trigger) {\n\t\tvar self = this;\n\n\t\t// Update body checkboxes when header checkbox is changed\n\t\t$(trigger).on(\"change\", function() {\n\t\t\tvar setChecked = this.checked;\n\n\t\t\tself.getCheckboxesForCheckbox(this).each(function() {\n\t\t\t\tthis.checked = setChecked;\n\t\t\t});\n\t\t});\n\n\t\tvar $checkboxes = self.getCheckboxesForCheckbox(trigger);\n\n\t\t// Update header checkbox when body checkboxes are changed\n\t\t$checkboxes.on(\"change.\" + pluginName, function() {\n\t\t\tvar checkedCount = 0;\n\t\t\t$checkboxes.each(function() {\n\t\t\t\tif (this.checked) {\n\t\t\t\t\tcheckedCount++;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvar allSelected = checkedCount === $checkboxes.length;\n\n\t\t\ttrigger.checked = allSelected;\n\n\t\t\t// only indeterminate if some are selected (not all and not none)\n\t\t\ttrigger.indeterminate = checkedCount !== 0 && !allSelected;\n\t\t});\n\t};\n\n\t// on tablecreate, init\n\t$(document).on(Tablesaw.events.create, function(e, tablesaw) {\n\t\tnew CheckAll(tablesaw);\n\t});\n\n\tTablesaw.CheckAll = CheckAll;\n})();\n\n\treturn Tablesaw;\n}));\n"]}